<?xml version="1.0"  ?><!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd"><pmc-articleset><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xml:lang="en" article-type="research-article" dtd-version="1.4"><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="pmc-domain-id">716</journal-id><journal-id journal-id-type="pmc-domain">bioinfo</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">PMC11879214</article-id><article-id pub-id-type="pmcid-ver">PMC11879214.1</article-id><article-id pub-id-type="pmcaid">11879214</article-id><article-id pub-id-type="pmcaiid">11879214</article-id><article-id pub-id-type="pmid">39913362</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btaf065</article-id><article-id pub-id-type="publisher-id">btaf065</article-id><article-version article-version-type="pmc-version">1</article-version><article-categories><subj-group subj-group-type="heading"><subject>Original Paper</subject><subj-group subj-group-type="category-toc-heading"><subject>Systems Biology</subject></subj-group></subj-group><subj-group subj-group-type="category-taxonomy-collection"><subject>AcademicSubjects/SCI01060</subject></subj-group></article-categories><title-group><article-title>ESPClust: unsupervised identification of modifiers for the effect size profile in omics association studies</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5663-5249</contrib-id><name name-style="western"><surname>P&#233;rez-Reche</surname><given-names initials="FJ">Francisco J</given-names></name><aff>
<institution>School of Natural and Computing Sciences, University of Aberdeen</institution>, Aberdeen AB24 3UE, <country country="GB">United Kingdom</country></aff><aff>
<institution>Department of Twin Research and Genetic Epidemiology, School of Life Course &amp; Population Sciences, King&#8217;s College London</institution>, London SE1 7EH, <country country="GB">United Kingdom</country></aff><xref rid="btaf065-cor1" ref-type="corresp"/></contrib><contrib contrib-type="author"><name name-style="western"><surname>Cheetham</surname><given-names initials="NJ">Nathan J</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="supporting">Investigation</role><aff>
<institution>Department of Twin Research and Genetic Epidemiology, School of Life Course &amp; Population Sciences, King&#8217;s College London</institution>, London SE1 7EH, <country country="GB">United Kingdom</country></aff></contrib><contrib contrib-type="author"><name name-style="western"><surname>Bowyer</surname><given-names initials="RCE">Ruth C E</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="supporting">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role><aff>
<institution>Department of Twin Research and Genetic Epidemiology, School of Life Course &amp; Population Sciences, King&#8217;s College London</institution>, London SE1 7EH, <country country="GB">United Kingdom</country></aff><aff>
<institution>The Alan Turing Institute</institution>, <addr-line>British Library</addr-line>, London NW1 2DB, <country country="GB">United Kingdom</country></aff></contrib><contrib contrib-type="author"><name name-style="western"><surname>Thompson</surname><given-names initials="EJ">Ellen J</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="supporting">Conceptualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="supporting">Investigation</role><aff>
<institution>School of Psychology, Faculty of Science, Engineering and Medicine, University of Sussex</institution>, Brighton BN1 9QH, <country country="GB">United Kingdom</country></aff></contrib><contrib contrib-type="author"><name name-style="western"><surname>Tettamanzi</surname><given-names initials="F">Francesca</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><aff>
<institution>Department of Twin Research and Genetic Epidemiology, School of Life Course &amp; Population Sciences, King&#8217;s College London</institution>, London SE1 7EH, <country country="GB">United Kingdom</country></aff></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9790-0571</contrib-id><name name-style="western"><surname>Menni</surname><given-names initials="C">Cristina</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role><aff>
<institution>Department of Twin Research and Genetic Epidemiology, School of Life Course &amp; Population Sciences, King&#8217;s College London</institution>, London SE1 7EH, <country country="GB">United Kingdom</country></aff></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4910-0489</contrib-id><name name-style="western"><surname>Steves</surname><given-names initials="CJ">Claire J</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="supporting">Conceptualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="equal">Funding acquisition</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="supporting">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="supporting">Methodology</role><aff>
<institution>Department of Twin Research and Genetic Epidemiology, School of Life Course &amp; Population Sciences, King&#8217;s College London</institution>, London SE1 7EH, <country country="GB">United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name name-style="western"><surname>Cheng</surname><given-names initials="J">Jianlin</given-names></name><role>Associate Editor</role></contrib></contrib-group><author-notes><corresp id="btaf065-cor1">Corresponding author. School of Natural and Computing Sciences, University of Aberdeen, Aberdeen AB24 3UE, United Kingdom. E-mail: <email>fperez-reche@abdn.ac.uk</email>.</corresp></author-notes><pub-date pub-type="collection"><month>2</month><year>2025</year></pub-date><pub-date pub-type="epub" iso-8601-date="2025-02-06"><day>06</day><month>2</month><year>2025</year></pub-date><volume>41</volume><issue>2</issue><issue-id pub-id-type="pmc-issue-id">481288</issue-id><elocation-id>btaf065</elocation-id><history><date date-type="received"><day>03</day><month>9</month><year>2024</year></date><date date-type="rev-recd"><day>08</day><month>1</month><year>2025</year></date><date date-type="editorial-decision"><day>30</day><month>1</month><year>2025</year></date><date date-type="accepted"><day>04</day><month>2</month><year>2025</year></date><date date-type="corrected-typeset"><day>28</day><month>2</month><year>2025</year></date></history><pub-history><event event-type="pmc-release"><date><day>06</day><month>02</month><year>2025</year></date></event><event event-type="pmc-live"><date><day>04</day><month>03</month><year>2025</year></date></event><event event-type="pmc-last-change"><date iso-8601-date="2025-03-06 22:25:26.330"><day>06</day><month>03</month><year>2025</year></date></event></pub-history><permissions><copyright-statement>&#169; The Author(s) 2025. Published by Oxford University Press.</copyright-statement><copyright-year>2025</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pmc-pdf" xlink:href="btaf065.pdf"/><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="btaf065.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>High-throughput omics technologies have revolutionized the identification of associations between individual traits and underlying biological characteristics, but still use &#8216;one effect-size fits all&#8217; approaches. While covariates are often used, their potential as effect modifiers often remains unexplored.</p></sec><sec id="s2"><title>Results</title><p>We propose ESPClust, a novel unsupervised method designed to identify covariates that modify the effect size of associations between sets of omics variables and outcomes. By extending the concept of moderators to encompass multiple exposures, ESPClust analyses the effect size profile (ESP) to identify regions in covariate space with different ESP, enabling the discovery of subpopulations with distinct associations. Applying ESPClust to synthetic data, insulin resistance and COVID-19 symptom manifestation, we demonstrate its versatility and ability to uncover nuanced effect size modifications that traditional analyses may overlook. By integrating information from multiple exposures, ESPClust identifies effect size modifiers in datasets that are too small for traditional univariate stratified analyses. This method provides a robust framework for understanding complex omics data and holds promise for personalised medicine.</p></sec><sec id="s3"><title>Availability and implementation</title><p>The source code ESPClust is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/fjpreche/ESPClust.git" ext-link-type="uri">https://github.com/fjpreche/ESPClust.git</ext-link>. It can be installed via Python package repositories as &#8216;pip install ESPClust==1.1.0&#8217;.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><institution-wrap><institution>Medical Research Council Fellowship</institution></institution-wrap></funding-source><award-id>MR/W021455/1</award-id></award-group></funding-group><counts><page-count count="11"/></counts><custom-meta-group><custom-meta><meta-name>pmc-status-qastatus</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>pmc-status-live</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-status-embargo</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-status-released</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-open-access</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-olf</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-manuscript</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-legally-suppressed</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-pdf</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-supplement</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-pdf-only</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-suppress-copyright</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-real-version</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-scanned-article</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-preprint</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-in-epmc</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-license-ref</meta-name><meta-value>CC BY</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec><title>1 Introduction</title><p>Rapidly expanding high-throughput technologies offer an unprecedented ability to identify associations between observed traits of individuals and biological endpoints via characterisation of various &#8216;omics&#8217; data. &#8216;Omics&#8217; represents a range of disciplines including genomics, proteomics, and metabolomics and allows elucidation of mechanisms and processes underpinning health and disease states (<xref rid="btaf065-B45" ref-type="bibr">Zierer <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btaf065-B28" ref-type="bibr">Misra <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btaf065-B38" ref-type="bibr">Suhre <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B42" ref-type="bibr">Uffelmann <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B18" ref-type="bibr">Julkunen <italic toggle="yes">et al.</italic> 2023</xref>).</p><p>Associations between omics variables and a given phenotypic outcome are often influenced by various covariates&#8212;characteristics of individuals or study conditions that may influence the observed association between an exposure (such as a biological measure) and an outcome (such as the presence of a disease). In association studies, effect size quantifies the strength of this relationship, reflecting the practical impact that changes in an exposure may have on the outcome (<xref rid="btaf065-B20" ref-type="bibr">Kirk 2005</xref>, <xref rid="btaf065-B10" ref-type="bibr">Ellis 2010</xref>). Covariates, which can include demographics (such as age, sex, body mass index&#8212;BMI&#8212;or ethnicity), biological diversity within samples (<xref rid="btaf065-B14" ref-type="bibr">Gough <italic toggle="yes">et al.</italic> 2017</xref>) or technical variation in the timing of collection, collection method, and processing of samples (<xref rid="btaf065-B22" ref-type="bibr">Leek <italic toggle="yes">et al.</italic> 2010</xref>), can affect the effect size. It is therefore standard practice to account for the potential confounding effects of such covariates when analysing associations between omics variables and outcomes.</p><p>In association studies, it is essential to distinguish between two primary roles of covariates: as confounders or as effect modifiers (or moderators). Confounders are covariates that influence both the exposure and the outcome, potentially leading to a spurious or misleading association if not accounted for. For example, age could confound an association between a gene expression level and a disease outcome if age affects both the gene expression and the risk of the disease (<xref rid="btaf065-B37" ref-type="bibr">Steves <italic toggle="yes">et al.</italic> 2012</xref>). To isolate the true association between the exposure and outcome, it is standard practice to adjust for confounding (<xref rid="btaf065-B21" ref-type="bibr">Lash <italic toggle="yes">et al.</italic> 2021</xref>).</p><p>Covariates can also act as effect modifiers, altering the effect size of associations rather than simply confounding them (<xref rid="btaf065-B21" ref-type="bibr">Lash <italic toggle="yes">et al.</italic> 2021</xref>). For instance, a biomarker might show a stronger association with a health outcome in older individuals than in younger ones, indicating age as an effect modifier. However, identifying effect modifiers is not systematically considered in omics association studies, likely due to the limited statistical power of typical datasets. Neglecting effect modification not only risks skewing effect size estimates but also disregards vital heterogeneity linked to covariates, which reflects the diversity within human populations. Recognising such diversity can prove invaluable in identifying target subpopulations for maximising intervention effectiveness or delineating thresholds that differentiate groups based on distinct characteristics. Understanding how effects are different within different subpopulations is the cornerstone of developing personalised medicine.</p><p>Here, we present ESPClust, an unsupervised method to identify covariates that modify the effect size of the association between a set of omics variables and an outcome, which can be used in relatively small sample sizes for discovery science. To facilitate this, we define an effect size profile (ESP), which is a collection of effect sizes representing the connections between various omics variables and the outcome. Rather than examining each effect size in isolation as done in classical univariate analysis (<xref rid="btaf065-B31" ref-type="bibr">Pepe <italic toggle="yes">et al.</italic> 1999</xref>, <xref rid="btaf065-B42" ref-type="bibr">Uffelmann <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B18" ref-type="bibr">Julkunen <italic toggle="yes">et al.</italic> 2023</xref>), the ESP captures the joint profile of effect sizes for multiple exposures. ESPClust works by dividing the space of covariates into regions of approximately homogeneous ESP, thus identifying clusters of individuals who share similar associations between their omics profile and the outcome. In essence, ESPClust extends the concept of effect modification to consider modification of the ESP, thereby capturing how the joint effect sizes of multiple exposures are influenced by covariates.</p><p>ESPClust is versatile and can be readily employed to explore connections between different omics datasets and outcomes. We evaluated its performance on synthetic datasets with known ground truth and applied it to real-world data to address specific research questions. The research questions were chosen to illustrate the ability of the method to (a) make discoveries in a highly researched area and (b) identify completely novel findings in an emerging disease. For the former, we investigated the relation between blood metabolomics and insulin resistance, an area which has already been heavily researched (<xref rid="btaf065-B32" ref-type="bibr">Roberts <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="btaf065-B30" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btaf065-B15" ref-type="bibr">Gu <italic toggle="yes">et al.</italic> 2020</xref>), providing a valuable context for our new findings. For the latter, we explored whether and how pre-pandemic blood metabolomics, reflecting pre-infection metabolism, influenced whether someone would become symptomatic after SARS-CoV-2 infection. Although numerous studies have analysed potential relationships between COVID-19 and blood metabolomics, they often concentrate on blood samples collected post-infection or use infection severity (such as hospitalisation) as the primary outcome (<xref rid="btaf065-B16" ref-type="bibr">Hasan <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B19" ref-type="bibr">Julkunen <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B24" ref-type="bibr">Mar&#237;n-Corral <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B35" ref-type="bibr">Sindelar <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btaf065-B6" ref-type="bibr">Ceballos <italic toggle="yes">et al.</italic> 2022</xref>). By considering a new question, we showcase the ability of ESPClust to analyse previously unexplored associations.</p></sec><sec><title>2 Materials and methods</title><sec><title>2.1 The ESPClust method</title><p>Given a set of <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> omics variables <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, we define the effect size profile (ESP) as the set <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, where each <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents the association between an individual omics variable <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and an outcome <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> (<xref rid="btaf065-F1" ref-type="fig">Fig. 1a</xref>). Effect sizes <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> can be estimated through various methods depending on the research context (<xref rid="btaf065-B20" ref-type="bibr">Kirk 2005</xref>, <xref rid="btaf065-B10" ref-type="bibr">Ellis 2010</xref>). The method can be applied to any set of effect sizes. However, for our applications, we calculate these using coefficients from linear regression models or odds ratios from logistic regression models. The relationship between <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> and <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, adjusted for confounders <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#8242;</mml:mo></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, is modelled as: 
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mi>f</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#8721;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mi mathvariant="normal">&#8242;</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#8242;</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>&#1013;</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>&#1013;</mml:mi></mml:math></inline-formula> is a normally distributed error. For a continuous outcome, we use linear regression with <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>Y</mml:mi></mml:math></inline-formula>, giving <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. For a binary outcome, we use logistic regression with <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">logit</mml:mi><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, yielding <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>&#946;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><fig position="float" id="btaf065-F1" orientation="portrait"><label>Figure 1.</label><caption><p>ESPClust method to identify regions in the covariate space with similar effect size profile. (a) Association between <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> omics variables (exposures) and an outcome <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> in terms of pair-wise effect sizes <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mi>&#160;</mml:mi></mml:math></inline-formula>that may depend on <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>J</mml:mi><mml:mi>&#160;</mml:mi></mml:math></inline-formula>covariates <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. (b) Schematic representation of the dependence of the standardized ESP <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> on the covariates. Panels (c)&#8211;(f) illustrate the method for a simple case with two omics variables, <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>, which depend on a single continuous covariate, <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula>. (c) The effect size for each omics variable is calculated within <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mn>6</mml:mn></mml:math></inline-formula> windows, <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mi>&#160;</mml:mi></mml:math></inline-formula>that cover the values taken by the covariate <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula>. (d) Clustering of the windows in the effect size space. Windows within a cluster have a similar effect size profile. <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the cluster centroids. (e) Window clusters in the covariate space defining regions shown with segments (top) or window midpoints (bottom). (f) Coordinates of the cluster centroids summarising the effect of the covariate <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>z</mml:mi></mml:math></inline-formula> on the association profile of each omics variable with the outcome.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf065f1.jpg"/></fig><p>ESPClust standardizes the ESP to a dimensionless set <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>, derived from <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> by subtracting the mean of each variable and normalizing by its standard deviation. We then suppose that each normalized effect size <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in the ESP can depend on <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>J</mml:mi></mml:math></inline-formula> covariates, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, which act as effect modifiers. The sets of confounders <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo>&#8242;</mml:mo></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> and effect modifiers <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> may overlap but are not necessarily identical. ESPClust generalizes univariate effect modification (<xref rid="btaf065-B3" ref-type="bibr">Bovbjerg and Johnson 2020</xref>, <xref rid="btaf065-B21" ref-type="bibr">Lash <italic toggle="yes">et al.</italic> 2021</xref>) to study how the entire ESP, <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>, varies across the covariate space defined by <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> (<xref rid="btaf065-F1" ref-type="fig">Fig. 1b</xref>).</p><p>The main aim of ESPClust is to identify regions in the covariate space where the ESP can be considered homogeneous. Within such regions, analyses that assume homogeneous effect sizes are valid. In contrast, assuming homogeneity for the ESP across distinct regions would not be justified.</p><p>ESPClust consists of three steps, outlined below.</p><sec><title>2.1.1 Step 1. Evaluation of the ESP as a function of the potential effect modifiers</title><p>Accounting for the effect modification of a discrete covariate <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula> such as sex or smoking status, simply requires estimating the ESP separately for each value of <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula>. However, with continuous covariates, the estimation process requires a more nuanced approach. Consider a scenario with <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>J</mml:mi></mml:math></inline-formula> continuous covariates, <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. Directly estimating the ESP at arbitrary points in the space is often infeasible due to data sparsity.</p><p>To address this challenge, we evaluate the ESP within a set of <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> windows <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> that collectively cover the region of the covariate space spanned by the data. These windows, which can overlap, allow data sparsity to be handled. The concept of a &#8216;cover&#8217; consisting of overlapping windows, rooted in topology (<xref rid="btaf065-B12" ref-type="bibr">Gamelin and Greene 1999</xref>), expands upon the traditional disjoint partitioning used in stratified analysis. Overlapping windows offer advantages: they eliminate the arbitrariness in defining strata that may intersect regions with heterogeneous ESPs, such as conventional age groups. They also provide a more detailed description of the dependence of effect sizes on covariates.</p><p>For a single covariate (<inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), windows are one-dimensional segments (<xref rid="btaf065-F1" ref-type="fig">Fig. 1c</xref>). For two covariates, they are rectangles (<xref rid="btaf065-F2" ref-type="fig">Fig. 2c</xref>). More generally, windows correspond to <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mi>J</mml:mi></mml:math></inline-formula>-dimensional hyperrectangles when <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mi>J</mml:mi></mml:math></inline-formula> covariates are considered.</p><fig position="float" id="btaf065-F2" orientation="portrait"><label>Figure 2.</label><caption><p>Illustration of the method for determining gliding window dimensions and step sizes in a dataset with two covariates <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. (a) Covariate space with <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:math></inline-formula> observations (circles). For each observation, the smallest rectangle encompassing the observation and its <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> nearest neighbours (<inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math></inline-formula>) is identified. Two example rectangles corresponding to observations <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mi>l</mml:mi></mml:math></inline-formula> are shown. (b) Histograms of rectangle side lengths (<inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) in the two covariate dimensions. The window size in each dimension is defined as the 95th percentile <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, while the gliding step <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>&#916;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>&#916;</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> is the minimum observed side length in each dimension. (c) Example of a gliding window with dimensions <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>, along with a copy shifted diagonally by <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>&#916;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>&#916;</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf065f2.jpg"/></fig><p>Once the set of windows is defined, ESPClust estimates the ESP within each window using the observations it contains and a model appropriate to the data (e.g. regression). For a given window <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the ESP is the set of univariate effect sizes, <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mi mathvariant="normal">ES</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>}</mml:mo></mml:math></inline-formula>. Step 1 of ESPClust produces a collection of <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> effect size profiles, <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mi mathvariant="normal">ES</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ES</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">ES</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, one for each window. These profiles are then used for clustering in Step 2, as described below.</p><p>We cover the <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi>J</mml:mi></mml:math></inline-formula>-dimensional covariate space using a gliding hyperrectangle with dimensions <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>. The hyperrectangle shifts incrementally in one or more directions at a time, with step sizes <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>. For instance, in two dimensions (<inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>), the windows may shift horizontally by <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>, vertically by <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), or diagonally by <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>. <xref rid="btaf065-F2" ref-type="fig">Figure 2c</xref> illustrates a rectangular window in two-dimensional covariate space, along with a copy obtained through a diagonal shift.</p><p>Ideally, windows should offer a detailed description of the dependence of ESP on covariates across a wide region of the covariate space while maintaining statistically robust estimates within each window. It is crucial that each window contains enough observations to support robust ESP estimates is critical. To achieve this, we developed an automated method to determine suitable window dimensions and gliding steps, ensuring that each window typically contains at least a pre-specified number of observations, <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>. <xref rid="btaf065-F2" ref-type="fig">Figure 2</xref> illustrates the method for two covariates.</p><p>Given a dataset with <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> observations and <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mi>J</mml:mi></mml:math></inline-formula> covariates, the method standardizes all covariates and identifies the smallest hyperrectangle containing each observation and its <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> nearest neighbours (<xref rid="btaf065-F2" ref-type="fig">Fig. 2a</xref>). Once the neighbourhood is determined, we back-transform to non-standardized covariates to obtain <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mi>N</mml:mi></mml:math></inline-formula> side-length estimates for each covariate, <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the (non-standardized) length of the <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>th side of the hyperrectangle for the <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>th observation. The <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>th side of the gliding windows is defined as the 95th percentile, <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>95</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, ensuring the window is typically large enough to include at least <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> observations, except in sparse regions (<xref rid="btaf065-F2" ref-type="fig">Fig. 2b</xref>).</p><p>The gliding step in the <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>th direction is defined as the smallest side length of the hyperrectangles for the <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>th covariate, i.e. <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>&#8289;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mfenced separators="|"><mml:mi>N</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> (<xref rid="btaf065-F2" ref-type="fig">Fig. 2b</xref>). This definition ensures that the gliding step is finely tuned to the data distribution, allowing for a systematic exploration of the covariate space to effectively capture local heterogeneities in effect sizes.</p><p>Once the gliding steps have been calculated, the total number of windows covering the covariate space is given by <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">&#8719;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the number of steps of the gliding window in the <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>-th covariate, <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="&#x230A;" close="&#x230B;" separators="|"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>. Here, <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are the maximum and minimum values of the <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>-th covariate in the dataset, respectively, and <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mfenced open="&#x230A;" close="&#x230B;" separators="|"><mml:mrow><mml:mo>&#8901;</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> is the floor function. The windows are centred at <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:math></inline-formula>. Some of these windows may contain fewer than <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> observations, particularly in sparse regions of the covariate space. Accordingly, the final number of windows within which the ESP is calculated is <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8804;</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>&#8242;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></sec><sec><title>2.1.2 Step 2. Clustering of windows with similar ESP</title><p>The <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mi mathvariant="normal">ES</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for each window <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is used as a vector of features that allows windows to be clustered in groups with similar ESP. <xref rid="btaf065-F1" ref-type="fig">Figure 1d</xref> illustrates the concept: Windows <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> used in <xref rid="btaf065-F1" ref-type="fig">Fig. 1c</xref> form a cluster where both <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> show a positive association across all three windows. In contrast, windows <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> form a separate cluster where the values of <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are negative and those of <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are positive. Agglomerative clustering will be used throughout the article, but ESPClust can be used with any other clustering method (<xref rid="btaf065-B13" ref-type="bibr">Gan <italic toggle="yes">et al.</italic> 2007</xref>).</p><p>The number of clusters identified by ESPClust can be manually set to any positive integer. However, we implemented an automated two-step process to determine a suitable number of clusters:</p><list list-type="roman-lower"><list-item><p>Determine the most frequent optimal cluster number <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> across four clustering indices: Calinski-Harabasz (<xref rid="btaf065-B5" ref-type="bibr">Calinski and Harabasz 1974</xref>), Davies-Bouldin (<xref rid="btaf065-B9" ref-type="bibr">Davies and Bouldin 1979</xref>), silhouette (<xref rid="btaf065-B33" ref-type="bibr">Rousseeuw 1987</xref>), and elbow (<xref rid="btaf065-B43" ref-type="bibr">Willmott 2019</xref>). If there is no repeated number across the four indices or in the case of a tie, <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is set to the smallest value among all the scores. The Calinski-Harabasz, Davies-Bouldin, and silhouette methods determine the optimal number of clusters by maximising their respective scores. The elbow method identifies the optimal number of clusters by locating the value <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> for which the change in slope of the clustering quadratic error (inertia, <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) is maximal. This corresponds to the most prominent &#8216;elbow&#8217; in the inertia vs. <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> plot. The slope of the inertia is defined as <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and the relative change of the slope as <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#948;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. The optimal <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> corresponds to the maximum of <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#948;</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>The clustering indices of step (i) split the windows into more than one group (i.e. <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>) even when the effect size is homogeneous over the covariate space. To test the statistical significance of splitting the data into <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> clusters compared to a non-clustered null hypothesis (<inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), we generate <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> reference datasets, with each feature uniformly distributed within the observed range of values. For each reference dataset, <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula>, the slope change <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">&#948;</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is computed. A p-value is then calculated as the proportion of reference datasets where <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">&#948;</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#948;</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, indicating cases where the observed elbow at <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is no more prominent than in the reference data. The null hypothesis of one cluster is rejected in favour of <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> if the p-value is below a significance level <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mi>&#945;</mml:mi></mml:math></inline-formula>.</p></list-item></list></sec><sec><title>2.1.3 Step 3. Identification of regions in the covariate space with homogeneous ESP</title><p>This step uses the window clusters obtained in Step 2 to identify regions in the covariate space with homogeneous ESP. <xref rid="btaf065-F1" ref-type="fig">Figure 1e</xref> illustrates the process for a case with a single effect modifier. In this example, the covariate space is split into two regions with &#8216;small&#8217; and &#8216;large&#8217; <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula>. Since the windows covering the covariate space can overlap, hard clustering of windows in the effect size space results in fuzzy clustering in the covariate space (<xref rid="btaf065-B13" ref-type="bibr">Gan <italic toggle="yes">et al.</italic> 2007</xref>). For instance, in <xref rid="btaf065-F1" ref-type="fig">Fig. 1e</xref>, segments overlap, allowing a specific value of the modifier to belong to multiple windows simultaneously. <xref rid="btaf065-F2" ref-type="fig">Figure 2c</xref> exemplifies the overlap of windows in a two-dimensional covariate space. This approach acknowledges that individuals sharing a common modifier (e.g. age) may exhibit varied associations between omics variables and outcomes. Nonetheless, we employ the midpoint of each window, <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></inline-formula> to provide a clearer visualization of regions characterized by homogeneous ESP (see the lower panel in <xref rid="btaf065-F1" ref-type="fig">Fig. 1e</xref>).</p><p>The centroids of the clusters serve as summaries of the ESP within each region, aiding in the interpretation of how covariates influence the relationship between each omics variable and the outcome. In <xref rid="btaf065-F1" ref-type="fig">Fig. 1f</xref>, the coordinates of the centroids and their dispersion are displayed. In this instance, the influence of the covariate <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula> on the association between the pair <inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is significantly greater than that on the pair <inline-formula id="IE132"><mml:math id="IM132" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. This is evident from the larger difference between the centroids <inline-formula id="IE133"><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE134"><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE135"><mml:math id="IM135" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mi/></mml:math></inline-formula>compared to those for <inline-formula id="IE136"><mml:math id="IM136" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:math></inline-formula> Ultimately, this discrepancy reflects the stronger dependency of <inline-formula id="IE137"><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> on <inline-formula id="IE138"><mml:math id="IM138" display="inline" overflow="scroll"><mml:mi>Z</mml:mi></mml:math></inline-formula>, as illustrated in <xref rid="btaf065-F1" ref-type="fig">Fig. 1c</xref>.</p></sec></sec><sec><title>2.2 Synthetic data</title><p>To evaluate the performance of ESPClust, we applied it to synthetic datasets with a known ground truth.</p><p>All datasets consider a dichotomous outcome <inline-formula id="IE139"><mml:math id="IM139" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> with values <inline-formula id="IE140"><mml:math id="IM140" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula> and consist of 100 observations for each class. Each observation includes 30 omics variables, <inline-formula id="IE141"><mml:math id="IM141" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>30</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>, and two effect modifiers, <inline-formula id="IE142"><mml:math id="IM142" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. The values of <inline-formula id="IE143"><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE144"><mml:math id="IM144" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> were drawn uniformly from <inline-formula id="IE145"><mml:math id="IM145" display="inline" overflow="scroll"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:math></inline-formula> (<xref rid="btaf065-F2" ref-type="fig">Fig. 2a</xref>). Three types of datasets were built which assume different dependences of the omics-outcome associations on the covariates <inline-formula id="IE146"><mml:math id="IM146" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>:</p><list list-type="order"><list-item><p>
<italic toggle="yes">Datasets D1</italic>: These datasets model situations without effect modification such that the effect sizes <inline-formula id="IE147"><mml:math id="IM147" display="inline" overflow="scroll"><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>30</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula> do not depend on <inline-formula id="IE148"><mml:math id="IM148" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. This is achieved by drawing the omics variables from a normal distribution with mean <inline-formula id="IE149"><mml:math id="IM149" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> and standard deviation 0.5 for all <inline-formula id="IE150"><mml:math id="IM150" display="inline" overflow="scroll"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula> (i.e. <inline-formula id="IE151"><mml:math id="IM151" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8764;</mml:mo><mml:mi/><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>). This distribution was used for observations with both <inline-formula id="IE152"><mml:math id="IM152" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula id="IE153"><mml:math id="IM153" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, ensuring no dependency on <inline-formula id="IE154"><mml:math id="IM154" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE155"><mml:math id="IM155" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>
<italic toggle="yes">Datasets D2</italic>: The covariate space <inline-formula id="IE156"><mml:math id="IM156" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> is divided into <italic toggle="yes">two regions</italic> with distinct associations between the omics variables and the outcome: Region A, where either <inline-formula id="IE157"><mml:math id="IM157" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE158"><mml:math id="IM158" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8804;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, and region B, where <inline-formula id="IE159"><mml:math id="IM159" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>. To make the regions more realistic, the boundary between them was smoothed, creating a gradual transition in membership probabilities near the thresholds (see dashed lines in <xref rid="btaf065-F3" ref-type="fig">Fig. 3a</xref>). For observations with <inline-formula id="IE160"><mml:math id="IM160" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, the omics variables were generated independently of <inline-formula id="IE161"><mml:math id="IM161" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. These variables were drawn as in D1 (<inline-formula id="IE162"><mml:math id="IM162" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8764;</mml:mo><mml:mi/><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>). These observations are shown as empty squares in <xref rid="btaf065-F3" ref-type="fig">Fig. 3a and b</xref>. For observations with <inline-formula id="IE163"><mml:math id="IM163" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>:</p><list list-type="bullet"><list-item><p>In region A, the omics variables followed the same distribution as <inline-formula id="IE174"><mml:math id="IM174" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, indicating no statistical association between the omics variables and the outcome in this region (orange circles in <xref rid="btaf065-F3" ref-type="fig">Fig. 3a and b</xref>).</p></list-item><list-item><p>In region B, the 30 omics variables were divided into three mutually exclusive random sets, each containing 10 variables. Within each set, the omics variables were drawn from <inline-formula id="IE175"><mml:math id="IM175" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8764;</mml:mo><mml:mi/><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>, with <inline-formula id="IE176"><mml:math id="IM176" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi/><mml:mn>2.7</mml:mn></mml:math></inline-formula> and <inline-formula id="IE177"><mml:math id="IM177" display="inline" overflow="scroll"><mml:mn>1.3</mml:mn></mml:math></inline-formula> for the three sets, respectively. This setup reflects the possibility that only a subset of the omics variables are influenced by the effect modifiers <inline-formula id="IE178"><mml:math id="IM178" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE179"><mml:math id="IM179" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item></list></list-item><list-item><p>
<italic toggle="yes">Datasets D3</italic>: The covariate space <inline-formula id="IE180"><mml:math id="IM180" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> is divided into <italic toggle="yes">three regions</italic> with distinct associations between the omics variables and the outcome: Region A, where <inline-formula id="IE181"><mml:math id="IM181" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, region B, where <inline-formula id="IE182"><mml:math id="IM182" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo></mml:math></inline-formula> and region C, where <inline-formula id="IE183"><mml:math id="IM183" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula> and <inline-formula id="IE184"><mml:math id="IM184" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>. The omics variables for <inline-formula id="IE185"><mml:math id="IM185" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> were generated as in datasets D2 (<inline-formula id="IE186"><mml:math id="IM186" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8764;</mml:mo><mml:mi/><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>). This same distribution was also used for observations with <inline-formula id="IE187"><mml:math id="IM187" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> in region A. In region B the omics variables were constructed similarly to region B in datasets D2. In region C, the variables were drawn as an independent random sample, following the same distribution as in region B but assigned to new random sets of 10 variables each. This reflects the presence of differential associations between the omics variables and the outcome in Regions B and C, driven by the effect modifiers.</p></list-item></list><fig position="float" id="btaf065-F3" orientation="portrait"><label>Figure 3.</label><caption><p>Application of ESPClust to synthetic data of type D2 with a dichotomous outcome, <inline-formula id="IE164"><mml:math id="IM164" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>&#8712;</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>, and two effect modifiers, <inline-formula id="IE165"><mml:math id="IM165" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. (a) Observations in the covariate space, with symbol shapes and colours denoting outcome (<inline-formula id="IE166"><mml:math id="IM166" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and region (A and B) as indicated in the legend. Dashed lines separate regions with distinct associations. Two example windows are shown, each of size <inline-formula id="IE167"><mml:math id="IM167" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mn>0.4</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> and shifted diagonally by <inline-formula id="IE168"><mml:math id="IM168" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>&#916;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>&#916;</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>0.16</mml:mn><mml:mo>,</mml:mo><mml:mn>0.16</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. (b) Omics variables for three selected observations with differing outcomes and/or association type (see legend in panel (a)). Symbols &#8216;+&#8217; and &#8216;&#8211;&#8217; mark omics variables with <inline-formula id="IE169"><mml:math id="IM169" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2.7</mml:mn></mml:math></inline-formula> and <inline-formula id="IE170"><mml:math id="IM170" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.3</mml:mn></mml:math></inline-formula> for observations with <inline-formula id="IE171"><mml:math id="IM171" display="inline" overflow="scroll"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> in region B. (c) Clusters in the covariate space identified by ESPClust. Symbols indicate the centres of windows. (d) Effect size for omics variables for each region in the covariate space. (e) Coordinates of the cluster centroids. Error bars in (d) and (e) represent <inline-formula id="IE172"><mml:math id="IM172" display="inline" overflow="scroll"><mml:mn>1.96</mml:mn><mml:mi>&#963;</mml:mi></mml:math></inline-formula>, where <inline-formula id="IE173"><mml:math id="IM173" display="inline" overflow="scroll"><mml:mi>&#963;</mml:mi><mml:mi>&#160;</mml:mi></mml:math></inline-formula>is the standard deviation of centroid coordinates.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf065f3.jpg"/></fig></sec><sec><title>2.3 Insulin resistance data</title><p>We used ESPClust to investigate the impact of BMI, sex, and gut microbiome gene richness (i.e. the number of unique microbial genes) on the relationship between serum metabolites and insulin resistance (HOMA-IR) among 275 non-diabetic individuals from the Danish MetaHIT study (<xref rid="btaf065-B27" ref-type="bibr">Metagenomics of the Human Intestinal Tract | METAHIT | Project | Fact sheet | FP7 | CORDIS | European Commission</xref>) (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Results will be presented for two examples using different metabolomic variables as exposures, as described in (<xref rid="btaf065-B23" ref-type="bibr">Lynch and Pedersen 2016</xref>, <xref rid="btaf065-B29" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic> 2018</xref>). We restricted our analysis to known metabolites within these datasets.</p></sec><sec><title>2.4 COVID-19 symptoms data</title><p>We utilized ESPClust to explore the potential of BMI, sex, and age as modifiers for the association between metabolomic variables collected before COVID-19 infection and the manifestation of COVID-19 symptoms (i.e. symptomatic or asymptomatic).</p><sec><title>2.4.1 Study population</title><p>Participants were selected from the UK Adult Twin Registry (<xref rid="btaf065-B41" ref-type="bibr">King's College London</xref>) based on the following criteria: they had pre-pandemic metabolomic data available, information on COVID-19 symptom status, and evidence of SARS-CoV-2 infection.</p></sec><sec><title>2.4.2 Exposure variables</title><p>The metabolite concentrations of fasting blood samples collected before the COVID-19 pandemic were measured with two different platforms that yielded the two metabolic datasets used in this study (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p><p>The first dataset was obtained through a high-throughput nuclear magnetic resonance (NMR) platform (<xref rid="btaf065-B36" ref-type="bibr">Soininen <italic toggle="yes">et al.</italic> 2009</xref>, <xref rid="btaf065-B44" ref-type="bibr">W&#252;rtz <italic toggle="yes">et al.</italic> 2017</xref>) by Nightingale Health Ltd, Helsinki, Finland. This platform provides the concentration of over 200 circulating metabolic biomarkers including lipids, fatty acids, amino acids, ketone bodies glycolysis-related metabolites as well as lipoprotein subclass distribution and particle size. Specifically, the first dataset consists of 221 biomarkers obtained from the serum of 680 participants of the TwinsUK cohort study(TwinsUK&#8212;The biggest twin registry in the UK for the study of ageing-related diseases).</p><p>The second dataset (C19-1) was obtained using an untargeted liquid chromatography-mass spectrometry (LC-MS) procedure conducted by Metabolon, Inc., Durham, North Carolina, USA as previously described (<xref rid="btaf065-B11" ref-type="bibr">Evans <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="btaf065-B34" ref-type="bibr">Shin <italic toggle="yes">et al.</italic> 2014</xref>). Our dataset comprises 774 pre-pandemic serum metabolites obtained from 368 TwinsUK participants.</p></sec><sec><title>2.4.3 Outcome variable</title><p>The outcome variable giving the symptom status was derived from self-reported symptoms (<xref rid="btaf065-B9147936" ref-type="bibr">Bowyer <italic toggle="yes">et al.</italic> 2023</xref>) in TwinsUK COVID-19 questionnaires (<xref rid="btaf065-B39" ref-type="bibr">Suthahar <italic toggle="yes">et al.</italic> 2021</xref>), administered between July 2020 and February 2022, and serology data (Cheetham <italic toggle="yes">et al.</italic> 2023). Infected participants were classified into two groups: asymptomatic or symptomatic. Participants were labelled as asymptomatic if they reported that had not had COVID-19 but there was evidence of SARS-CoV-2 infection. In contrast, participants were assumed to be symptomatic if there was evidence of natural infection, reported having had COVID-19 and provided the duration of their symptoms (this was imposed to strengthen the evidence that these patients were symptomatic). Information on symptoms was obtained from three TwinsUK COVID-19 questionnaires (<xref rid="btaf065-B39" ref-type="bibr">Suthahar <italic toggle="yes">et al.</italic> 2021</xref>) administered in July&#8211;August 2020 (Q2), October&#8211;November 2020 (Q3), and November 2021&#8211;February 2022 (Q4). Evidence of SARS-CoV-2 infection was confirmed through antibody testing conducted around the times of Q2 and Q4. Testing data were supplemented with self-reported vaccination records to ensure accuracy; participants were considered infected if they had a positive anti-Nucleocapsid result at any time or a positive anti-Spike result prior to vaccination (<xref rid="btaf065-B17" ref-type="bibr">Interim Guidelines for COVID-19 Antibody Testing | CDC</xref>).</p></sec><sec><title>2.4.4 Missing data and data transformation</title><p>Metabolites whose concentration was missing for more than 20% of individuals were discarded. Similarly, individuals who missed more than 20% of the metabolites were also discarded. The remaining missing values for metabolites were imputed using k Nearest Neighbours (<xref rid="btaf065-B26" ref-type="bibr">Mendez <italic toggle="yes">et al.</italic> 2019</xref>) with <inline-formula id="IE188"><mml:math id="IM188" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula>.</p><p>Sex was encoded as a numerical variable (0 for male and 1 for female); the remaining variables are intrinsically numerical. Metabolites were individually transformed by adding one and applying the natural logarithm function. All variables were individually standardized by subtracting the mean value and dividing by the standard deviation.</p></sec></sec></sec><sec><title>3 Results</title><sec><title>3.1 Synthetic data</title><p>To gain statistical insight, we applied ESPClust to identify clusters in the covariate space <inline-formula id="IE189"><mml:math id="IM189" display="inline" overflow="scroll"><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula> across 500 datasets of each type (D1&#8211;D3). Windows containing at least <inline-formula id="IE190"><mml:math id="IM190" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math></inline-formula> observations were used. While the value of <inline-formula id="IE191"><mml:math id="IM191" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> is chosen by the analyst, it is essential to select sufficiently large values when dealing with dichotomous outcomes. This ensures that both outcome values are represented within the windows, which is necessary for calculating effect sizes. Effect sizes within windows were estimated using univariate logistic regression.</p><p>
<xref rid="btaf065-T1" ref-type="table">Table 1</xref> shows a contingency matrix summarising the number of inferred clusters for each type of dataset for a significance level <inline-formula id="IE192"><mml:math id="IM192" display="inline" overflow="scroll"><mml:mi>&#945;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in Step 2.ii of ESPClust.</p><table-wrap position="float" id="btaf065-T1" orientation="portrait"><label>Table 1.</label><caption><p>Contingency matrix showing the distribution of clusters identified by ESPClust across 500 datasets for each type (D1, D2, and D3).</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th colspan="2" rowspan="2"/><th colspan="5" align="center" rowspan="1">Number of clusters<hr/></th></tr><tr><th align="center" rowspan="1" colspan="1">1</th><th align="center" rowspan="1" colspan="1">2</th><th align="center" rowspan="1" colspan="1">3</th><th align="center" rowspan="1" colspan="1">4</th><th align="center" rowspan="1" colspan="1">5</th></tr></thead><tbody><tr><td rowspan="3" colspan="1">Number of regions</td><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">457</td><td rowspan="1" colspan="1">13</td><td rowspan="1" colspan="1">23</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">486</td><td rowspan="1" colspan="1">7</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">22</td><td rowspan="1" colspan="1">34</td><td rowspan="1" colspan="1">394</td><td rowspan="1" colspan="1">43</td><td rowspan="1" colspan="1">7</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>Datasets of type D1, D2, and D3 contain 1, 2, and 3 true regions, respectively. Rows represent the number of true regions, while columns represent the number of clusters identified by the method.</p></fn></table-wrap-foot></table-wrap><p>Datasets D1 were designed to simulate a uniform association across the whole covariate space, where one would expect a single cluster with homogeneous association. ESPClust performed well, identifying one cluster in 457 datasets D1 (91% of cases).</p><p>For datasets D2, where two clusters corresponding to regions A and B are expected, ESPClust identified two clusters in 486 of the datasets, representing a 97% frequency. <xref rid="btaf065-F3" ref-type="fig">Figure 3c</xref> shows the clusters discovered by ESPClust for a dataset of type D2, which approximate the predefined regions A and B indicated in <xref rid="btaf065-F3" ref-type="fig">Fig. 3a</xref>. The lack of points near the boundaries of the covariate space is due to windows containing fewer than <inline-formula id="IE193"><mml:math id="IM193" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:math></inline-formula> observations.</p><p>Notably, the differences in the statistical associations of individual omics variables with the outcome across regions A and B are small, as shown in <xref rid="btaf065-F3" ref-type="fig">Fig. 3d</xref> by the overlapping effect sizes for most metabolites. Similarly, the centroids of the two clusters show only minor statistical differences (<xref rid="btaf065-F3" ref-type="fig">Fig. 3e</xref>). Despite these subtle variations, ESPClust successfully identified two distinct clusters. This demonstrates its ability to leverage the ESP rather than relying solely on individual effect sizes, overcoming the limitations of traditional stratification and univariate analysis in such scenarios.</p><p>For datasets D3, where three clusters corresponding to regions A, B, and C are expected, ESPClust identified three clusters in 394 simulations (79% of cases, <xref rid="btaf065-T1" ref-type="table">Table 1</xref>). While the performance is lower than for datasets D2, it remains impressive given the subtle differences between regions A, B, and C at the level of individual omics variables. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> illustrates the results for a particular dataset of type D3.</p><p>These results demonstrate the robustness and accuracy of ESPClust in detecting association clusters across diverse datasets, even when individual-level differences in effect sizes are small or indistinguishable.</p><p>To obtain the results presented above, ESPClust calculated the window dimensions <inline-formula id="IE194"><mml:math id="IM194" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> and gliding steps <inline-formula id="IE195"><mml:math id="IM195" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) for each dataset as described in Step 1. To assess the sensitivity of ESPClust to variations in window dimensions and gliding steps, we replicated the analysis presented above while varying them from the baseline values of <inline-formula id="IE196"><mml:math id="IM196" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE197"><mml:math id="IM197" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) used in the above analysis.</p><p>Halving the gliding steps led ESPClust to identify a single cluster in 391 out of 500 datasets of type D1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>), a decline compared to the 457 cases identified using the baseline parameters (<xref rid="btaf065-T1" ref-type="table">Table 1</xref>). Similarly, increasing the window dimensions to <inline-formula id="IE198"><mml:math id="IM198" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mn>1.5</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mn>1.5</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> while keeping the baseline gliding steps resulted in further deterioration, with only 365 datasets of type D1 correctly identified as having one cluster (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>).</p><p>In contrast, increasing the gliding steps to <inline-formula id="IE199"><mml:math id="IM199" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mn>1.5</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> while maintaining the baseline window dimensions improved performance in terms of D1 datasets, with ESPClust identifying a single cluster in 482 datasets of type D1 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). However, this improvement came at the expense of the ability to correctly identify two or three clusters, which deteriorated significantly compared to the baseline parameters (cf. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> and <xref rid="btaf065-T1" ref-type="table">Table 1</xref>).</p><p>Overall, the baseline parameters provide a good balance, achieving robust accuracy for cases with and without effect modifiers.</p></sec><sec><title>3.2 Insulin resistance data</title><p>For the first application of ESPClust to insulin resistance data, we used 94 polar metabolites from the Danish MetaHIT study as the exposures (<xref rid="btaf065-B30" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic> 2016</xref>). The effect sizes of step 1 in ESPClust were calculated with linear regression for each sex, using windows of size <inline-formula id="IE200"><mml:math id="IM200" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BMI</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">rich</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>5.7</mml:mn><mml:mo/><mml:mi mathvariant="normal">kg</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mn>168</mml:mn><mml:mo>&#8194;</mml:mo><mml:mn>895</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> and gliding steps <inline-formula id="IE201"><mml:math id="IM201" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BMI</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">rich</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1.0</mml:mn><mml:mo/><mml:mi mathvariant="normal">kg</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo>&#8194;</mml:mo><mml:mn>294</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> (see grey rectangle in <xref rid="btaf065-F4" ref-type="fig">Fig. 4c</xref>). Only windows containing more than 10 observations (<inline-formula id="IE202"><mml:math id="IM202" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>) were considered. Within each window, the effect size for every metabolite was calculated as the slope of a linear regression model, adjusting for both BMI and gene richness.</p><fig position="float" id="btaf065-F4" orientation="portrait"><label>Figure 4.</label><caption><p>Application of ESPClust to study the association between insulin resistance and 94 serum metabolites. (a) Example of the effect size within windows for aminomalonic acid and decanoic acid in the covariate space (BMI, sex, gene richness). The error bars in the plots for BMI and gene richness indicate the size of the window used to cover these covariates. (b) Visualization of two clusters with different ESP using the first two principal components of the windows effect sizes. (c) Clusters in the covariate space separately shown for males and females. The symbols indicate the middle point of the windows used to estimate the effect sizes. The size of the window used to calculate effect sizes for fixed sex is shown by a grey rectangle. (d) The left panel shows the coordinates of the cluster centroids corresponding to the 20 metabolites that differ the most between clusters. The error bars indicate 1.96<inline-formula id="IE203"><mml:math id="IM203" display="inline" overflow="scroll"><mml:mi>&#963;</mml:mi></mml:math></inline-formula>, where <inline-formula id="IE204"><mml:math id="IM204" display="inline" overflow="scroll"><mml:mi>&#963;</mml:mi></mml:math></inline-formula> is the standard deviation of the centroid coordinates. The central panel shows the effect size for the same metabolites for two groups of individuals representing the two identified clusters. The third panel shows the same effect sizes as in the second panel but the 95% confidence intervals for the effect sizes are shown with error bars.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf065f4.jpg"/></fig><p>
<xref rid="btaf065-F4" ref-type="fig">Figure 4a</xref> shows the dependence of the effect size on each of the covariates for two metabolites which exemplify different levels of heterogeneity: the association between aminomalonic acid and insulin resistance exhibits more pronounced variation with the covariates compared to that of decanoic acid.</p><p>ESPClust splits the windows into two clusters (<italic toggle="yes">P</italic>-value <inline-formula id="IE205"><mml:math id="IM205" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). This also looks appropriate when projecting the window effect sizes onto the two first principal components (<xref rid="btaf065-F4" ref-type="fig">Fig. 4b</xref>). <xref rid="btaf065-F4" ref-type="fig">Figure 4c</xref> shows that Cluster 1 comprises female individuals with high BMI and low gene richness. It cannot be established whether Cluster 1 extends to the region of high BMI and low gene richness for males due to insufficient data in this region for this group.</p><p>In <xref rid="btaf065-F4" ref-type="fig">Fig. 4d</xref> (left), the centroid coordinates corresponding to the 20 metabolites with the most significant differences between clusters are shown. This highlights that, in addition to differing in ESP collectively, distinct clusters also diverge at the level of specific individual metabolites (such as cholesterol or glycine).</p><p>Previous studies have suggested that elevated levels of cholesterol are linked with obesity (i.e. high BMI), increased insulin resistance (<xref rid="btaf065-B25" ref-type="bibr">Mc Auley 2020</xref>), and reduced gene richness (<xref rid="btaf065-B8" ref-type="bibr">Cotillard <italic toggle="yes">et al.</italic> 2013</xref>). Our findings suggest that BMI and insulin resistance may not only confound the association between cholesterol and insulin resistance but also act as effect modifiers, amplifying the positive association in cluster 1 (i.e. among individuals with high BMI and low gene diversity). Similarly, ESPClust indicates that the negative association between glycine levels and insulin resistance (<xref rid="btaf065-B2" ref-type="bibr">Alves <italic toggle="yes">et al.</italic> 2019</xref>) is moderated by BMI and gene diversity.</p><p>To compare the results of ESPClust with traditional univariate methods using stratification, we categorised individuals into two groups representing the clusters identified by ESPClust. Cluster 1 was represented by individuals with BMI <inline-formula id="IE206"><mml:math id="IM206" display="inline" overflow="scroll"><mml:mo>&#8805;</mml:mo></mml:math></inline-formula> 26&#8201;kg/m<sup>2</sup> and gene richness <inline-formula id="IE207"><mml:math id="IM207" display="inline" overflow="scroll"><mml:mo>&#8804;</mml:mo></mml:math></inline-formula> 480<inline-formula id="IE208"><mml:math id="IM208" display="inline" overflow="scroll"><mml:mo>&#8194;</mml:mo></mml:math></inline-formula>000 (<xref rid="btaf065-B8" ref-type="bibr">Cotillard <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btaf065-B7" ref-type="bibr">Le Chatelier <italic toggle="yes">et al.</italic> 2013</xref>); cluster 0 was represented by the rest of individuals.</p><p>
<xref rid="btaf065-F4" ref-type="fig">Figure 4d</xref> (centre) shows that the effect size for the most distinct metabolites exhibits trends similar to those of the centroid coordinates (<xref rid="btaf065-F4" ref-type="fig">Fig. 4d</xref> (left)). However, the differences in effect sizes do not achieve statistical significance, as evidenced by the overlap of error bars in <xref rid="btaf065-F4" ref-type="fig">Fig. 4d</xref> (right). This reinforces the idea illustrated above for synthetic data: ESPClust can identify clusters with varying ESP levels that may not be discernible combining traditional stratification and univariate analysis. Indeed, ESPClust may detect collective differences between effect size profiles that may not be prominent at the level of individual omics variables unless large datasets are used to enhance the power of univariate analysis.</p><p>As a second example in the context of insulin resistance, we utilised ESPClust with 289 lipids from the Danish MetaHIT study as exposures (<xref rid="btaf065-B30" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic> 2016</xref>). Our findings mirrored those obtained with 94 metabolites. Using gliding windows of the same size and step as in the 94 metabolites dataset, the covariate space was again divided into two clusters, splitting the (BMI, gene richness) space in a similar manner. However, with the 289 lipids dataset, cluster 1&#8212;corresponding to individuals with high BMI and low gene richness&#8212;extended to higher values of gene richness and included the male subspace (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2a</xref>).</p><p>The coordinates of the cluster centroids for the lipidomic dataset did not exhibit statistically significant differences between the clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2b</xref>). However, there is a noticeably tendency for several triglycerides (e.g. TG(56:5)) to show higher effect sizes within Cluster 1. This aligns with previous studies linking elevated triglyceride levels to obesity, low gene richness, and metabolic disorders such as insulin resistance (<xref rid="btaf065-B7" ref-type="bibr">Le Chatelier <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btaf065-B1" ref-type="bibr">Agus <italic toggle="yes">et al.</italic> 2021</xref>). Our findings suggest that the positive association between triglycerides and insulin resistance is particularly strengthened in regions characterized by high BMI and low gene richness.</p></sec><sec><title>3.3 COVID-19 symptoms data</title><p>Since the symptomatic/asymptomatic outcome in the COVID-19 datasets is binary, the potential ESP dependence on BMI, age and sex was estimated through univariate logistic regression within windows that cover the covariate space.</p><p>For the first dataset, based on 221 NMR metabolites, we applied ESPClust with a minimum of <inline-formula id="IE209"><mml:math id="IM209" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:math></inline-formula> observations per window. This resulted in window sizes <inline-formula id="IE210"><mml:math id="IM210" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BMI</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">age</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>6.6</mml:mn><mml:mo/><mml:mi mathvariant="normal">kg</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mn>20</mml:mn><mml:mo/><mml:mi mathvariant="normal">years</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and a gliding step of <inline-formula id="IE211"><mml:math id="IM211" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BMI</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">age</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1.7</mml:mn><mml:mo/><mml:mi mathvariant="normal">kg</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo/><mml:mi mathvariant="normal">years</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> for each sex, which were grouped into two clusters (<xref rid="btaf065-F5" ref-type="fig">Fig. 5</xref>). Although the clustering seems reasonable in the PCA plot of <xref rid="btaf065-F5" ref-type="fig">Fig. 5a</xref>, the differences between the two clusters are not easily interpretable in terms of BMI, age, and sex.</p><fig position="float" id="btaf065-F5" orientation="portrait"><label>Figure 5.</label><caption><p>Results obtained by employing EPSClust to investigate the potential role of BMI, sex, and age on the association between COVID-19 symptoms manifestation and serum metabolomics. Panels (a&#8211;c) show findings from ESPClust analysis using 221 NMR blood biomarkers as exposures, while panels (d&#8211;f) present analogous results obtained using 774 LC-MS blood metabolites. (a, d) Visualisation of the clusters for the ESP, using the first two principal components of the window effect sizes. (b, e) Clusters in the covariate space separately shown for male and female individuals. The symbols indicate the middle point of the windows used to estimate effect sizes. The size of the gliding window used to calculate effect sizes for fixed sex is represented by a grey rectangle in the panel for male individuals. (c, f) Coordinates of the cluster centroids corresponding to the 20 metabolites that differ the most between clusters. The error bars indicate 1.96<inline-formula id="IE212"><mml:math id="IM212" display="inline" overflow="scroll"><mml:mi>&#963;</mml:mi></mml:math></inline-formula>, where <inline-formula id="IE213"><mml:math id="IM213" display="inline" overflow="scroll"><mml:mi>&#963;</mml:mi></mml:math></inline-formula> is the standard deviation of the centroid coordinates.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf065f5.jpg"/></fig><p>The coordinates of the cluster centroids overlap, and no individual metabolite exhibits a distinctly different effect size across clusters (<xref rid="btaf065-F5" ref-type="fig">Fig. 5c</xref>). In this application, the differences between the clusters are therefore linked to the EPS as a whole. Nevertheless, there is a notable trend for several VLDL and LDL ratios to show higher effect sizes in Cluster 1. A larger dataset might lead to a statistically clearer trend in this direction.</p><p>For the second metabolomics dataset, which includes 774 LC-MS metabolites, imposing <inline-formula id="IE214"><mml:math id="IM214" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:math></inline-formula> yielded window sizes of <inline-formula id="IE215"><mml:math id="IM215" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BMI</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">age</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>7.5</mml:mn><mml:mo/><mml:mi mathvariant="normal">kg</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mi/><mml:mn>20</mml:mn><mml:mo/><mml:mi mathvariant="normal">years</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and gliding steps of <inline-formula id="IE216"><mml:math id="IM216" display="inline" overflow="scroll"><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">BMI</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#916;</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">age</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>2.3</mml:mn><mml:mo/><mml:mi mathvariant="normal">kg</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo/><mml:mi mathvariant="normal">years</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> for each sex. ESPClust splits the windows into two clusters in the female subspace (<xref rid="btaf065-F5" ref-type="fig">Fig. 5e</xref>) which appear reasonable separated in the PCA plot (<xref rid="btaf065-F5" ref-type="fig">Fig. 5d</xref>). No windows in the male subspace contained sufficient data to estimate the ESP (<xref rid="btaf065-F5" ref-type="fig">Fig. 5e</xref>).</p><p>In terms of age, the split of windows in the female subspace obtained using the 774 LC-MS metabolites (<xref rid="btaf065-F5" ref-type="fig">Fig. 5e</xref>, right) is more intuitive than that obtained using 221 NMR metabolites (<xref rid="btaf065-F5" ref-type="fig">Fig. 5b</xref>, right). A possible explanation for the enhanced interpretability is that increasing the number of metabolites enhances the resolution of the dependence of the EPS on the covariates. At the level of individual metabolites, however, significant overlap between clusters persists (<xref rid="btaf065-F5" ref-type="fig">Fig. 5f</xref>).</p></sec></sec><sec><title>4 Discussion</title><p>We have introduced ESPClust, a flexible method for unsupervised identification of effect size modifiers in omics association studies. The method expands upon the concept of effect size modification, traditionally related to the association between an exposure-outcome pair, to utilise the information provided by a set of effect sizes for the association of multiple omics variables and an outcome. This collection of effect sizes defines the effect size profile, referred to as ESP. ESPClust finds regions in the covariate space with differing ESP, effectively generalising the effect size modification concept for individual omics variables to the concept of ESP modification.</p><p>An ESP modifier may function as an effect modifier for individual omics variables, as demonstrated in our analysis of serum metabolites and insulin resistance. However, ESP modification captures phenomena not discernible at the individual omics level, as shown in our synthetic data or the COVID-19 symptom phenotype analysis.</p><p>A crucial step in ESPClust is to decide if there is more than one region in the covariate space with differing ESP, i.e. whether there is evidence supporting the split of ESP windows into more than one cluster. ESPClust uses a test that compares the slope changes of the clustering inertia in the observed data with the changes expected for non-clustered data. We explored the possibility of using the gap statistic instead which is often used to test if the data falls into a single cluster (<xref rid="btaf065-B40" ref-type="bibr">Tibshirani <italic toggle="yes">et al.</italic> 2001</xref>). However, the gap statistic systematically grows with the number of clusters when applied to our synthetic data and does not allow us to identify a single cluster even for datasets of type D1 with homogeneous association across the whole covariate space (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).</p><p>ESPClust offers considerable potential for advancing personalised medicine by identifying subpopulations with distinct biological responses. By detecting covariate-specific effect size modifications even using relatively small datasets, ESPClust reveals subtle heterogeneities that traditional methods may miss. This ability to tailor interventions based on individual biological profiles can enhance treatment efficacy and precision. Consequently, ESPClust facilitates the development of more personalised healthcare strategies, improving patient outcomes and driving progress in the field of personalised medicine.</p><p>Although this paper has focused on omics association studies, ESPClust is very versatile and can be applied well beyond this field. Indeed, it can be applied to any problem involving features used to predict outcomes influenced by effect modifiers, as it excels at identifying context-dependent relationships and clustering features based on shared effect size patterns. By accounting for how moderators shape associations, ESPClust provides a framework to uncover nuanced, subgroup-specific insights that are crucial for understanding complex systems and tailoring interventions across diverse domains.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="sup1" position="float" content-type="local-data" orientation="portrait"><label>btaf065_Supplementary_Data</label><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="btaf065_supplementary_data.docx" position="float" orientation="portrait"/></supplementary-material></sec></body><back><sec><title>Author contributions</title><p>Francisco Perez-Reche (Conceptualization [lead], Formal analysis [lead], Funding acquisition [equal], Investigation [lead], Methodology [lead], Software [lead]), Nathan J. Cheetham (Data curation [equal], Investigation [supporting]), Ruth C.E. Bowyer (Investigation [supporting], Methodology [supporting]), Ellen J. Thompson (Conceptualization [supporting], Investigation [supporting]), Francesca Tettamanzi (Data curation [equal]), Cristina Menni (Data curation [equal], Methodology [supporting]), and Claire Joanne Steves (Conceptualization [supporting], Funding acquisition [equal], Investigation [supporting], Methodology [supporting])</p></sec><sec><title>Supplementary data</title><p>
<xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p><p>Conflict of interest: None declared.</p></sec><sec><title>Funding</title><p>We acknowledge financial support from the UKRI COVID-19 Longitudinal Health and Wellbeing National Core Study. F.J.P.-R. acknowledges funding support from a Medical Research Council Fellowship (MR/W021455/1).</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>The metabolomic data for the examples of insulin resistance are available at (<xref rid="btaf065-B29" ref-type="bibr">Pedersen <italic toggle="yes">et al.</italic> 2018</xref>) <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bitbucket.org/hellekp/clinical-micro-meta-integration/src/master/" ext-link-type="uri">https://bitbucket.org/hellekp/clinical-micro-meta-integration/src/master/</ext-link>. The data used for the COVID-19 examples are held by the Department of Twin Research at King&#8217;s College London. The data can be released to bona fide researchers using our normal procedures overseen by the Wellcome Trust and its guidelines as part of our core funding (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://twinsuk.ac.uk/resources-for-researchers/access-our-data/" ext-link-type="uri">https://twinsuk.ac.uk/resources-for-researchers/access-our-data/</ext-link>).</p></sec><ref-list id="ref1"><title>References</title><ref id="btaf065-B1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Agus</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Cl&#233;ment</surname><given-names>K</given-names></string-name>, <string-name name-style="western"><surname>Sokol</surname><given-names>H</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Gut microbiota-derived metabolites as central regulators in metabolic disorders</article-title>. <source>Gut</source> &#160;<year>2021</year>;<volume>70</volume>:<fpage>1174</fpage>&#8211;<lpage>82</lpage>.<pub-id pub-id-type="pmid">33272977</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1136/gutjnl-2020-323071</pub-id><pub-id pub-id-type="pmcid">PMC8108286</pub-id></mixed-citation></ref><ref id="btaf065-B2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Alves</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Bassot</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Bulteau</surname><given-names>A-L</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Glycine metabolism and its alterations in obesity and metabolic diseases</article-title>. <source>Nutrients</source> &#160;<year>2019</year>;<volume>11</volume>:<fpage>1356</fpage>&#8211;<lpage>84</lpage>.<pub-id pub-id-type="pmid">31208147</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3390/nu11061356</pub-id><pub-id pub-id-type="pmcid">PMC6627940</pub-id></mixed-citation></ref><ref id="btaf065-B3"><mixed-citation publication-type="other"><person-group person-group-type="author"><string-name name-style="western"><surname>Bovbjerg</surname><given-names>ML.</given-names></string-name></person-group> &#160;<italic toggle="yes">Foundations of Epidemiology</italic>. Corvallis, US: Oregon State University, 2021.</mixed-citation></ref><ref id="btaf065-B9147936"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Bowyer</surname><given-names>RCE</given-names>, </string-name>, <string-name name-style="western"><surname>Huggins</surname><given-names>C</given-names>, </string-name>, <string-name name-style="western"><surname>Toms</surname><given-names>R</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Characterising patterns of COVID-19 AND long COVID symptoms: evidence from nine UK longitudinal studies</article-title>. <source>Eur J Epidemiol</source> &#160;<year>2023</year>;<volume>38</volume>:<fpage>199</fpage>&#8211;<lpage>210</lpage>. <pub-id pub-id-type="doi">10.1007/s10654-022-00962-6</pub-id><pub-id pub-id-type="pmid">36680646</pub-id><pub-id pub-id-type="pmcid">PMC9860244</pub-id></mixed-citation></ref><ref id="btaf065-B5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Calinski</surname><given-names>T</given-names></string-name>, <string-name name-style="western"><surname>Harabasz</surname><given-names>J.</given-names></string-name></person-group> &#160;<article-title>A dendrite method for cluster analysis</article-title>. <source>Commun Stats Theory Methods</source> &#160;<year>1974</year>;<volume>3</volume>:<fpage>1</fpage>&#8211;<lpage>27</lpage>.</mixed-citation></ref><ref id="btaf065-B6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Ceballos</surname><given-names>FC</given-names></string-name>, <string-name name-style="western"><surname>Virseda-Berdices</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Resino</surname><given-names>S</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Metabolic profiling at COVID-19 onset shows disease severity and sex-specific dysregulation</article-title>. <source>Front Immunol</source> &#160;<year>2022</year>;<volume>13</volume>:<fpage>925558</fpage>.<pub-id pub-id-type="pmid">35844615</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3389/fimmu.2022.925558</pub-id><pub-id pub-id-type="pmcid">PMC9280146</pub-id></mixed-citation></ref><ref id="btaf065-B17"><mixed-citation publication-type="other"><collab>Centers for Disease Control and Prevention</collab>. <italic toggle="yes">Interim Guidelines for COVID-19 Antibody Testing.</italic> &#160;<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://archive.cdc.gov/www_cdc_gov/coronavirus/2019-ncov/hcp/testing/antibody-tests-guidelines.html" ext-link-type="uri">https://archive.cdc.gov/www_cdc_gov/coronavirus/2019-ncov/hcp/testing/antibody-tests-guidelines.html</ext-link> (7 December 2024, date last accessed)</mixed-citation></ref><ref id="btaf065-B8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Cotillard</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Kennedy</surname><given-names>SP</given-names></string-name>, <string-name name-style="western"><surname>Kong</surname><given-names>LC</given-names></string-name></person-group> &#160;<etal>et al</etal>; <collab>ANR MicroObes Consortium</collab>. <article-title>Dietary intervention impact on gut microbial gene richness</article-title>. <source>Nature</source> &#160;<year>2013</year>;<volume>500</volume>:<fpage>585</fpage>&#8211;<lpage>8</lpage>.<pub-id pub-id-type="pmid">23985875</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/nature12480</pub-id></mixed-citation></ref><ref id="btaf065-B9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Davies</surname><given-names>DL</given-names></string-name>, <string-name name-style="western"><surname>Bouldin</surname><given-names>DW.</given-names></string-name></person-group> &#160;<article-title>A cluster separation measure</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source> &#160;<year>1979</year>;<volume>1</volume>:<fpage>224</fpage>&#8211;<lpage>7</lpage>.<pub-id pub-id-type="pmid">21868852</pub-id></mixed-citation></ref><ref id="btaf065-B10"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name name-style="western"><surname>Ellis</surname><given-names>PD.</given-names></string-name></person-group> &#160;<source>The Essential Guide to Effect Sizes</source>. <publisher-loc>Cambridge, UK</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>, <year>2010</year>.</mixed-citation></ref><ref id="btaf065-B27"><mixed-citation publication-type="other"><collab>European Comission</collab>. <italic toggle="yes">Metagenomics of the Human Intestinal Tract</italic>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://cordis.europa.eu/project/id/201052" ext-link-type="uri">https://cordis.europa.eu/project/id/201052</ext-link> (14 April 2024, date last accessed).</mixed-citation></ref><ref id="btaf065-B11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Evans</surname><given-names>A</given-names></string-name></person-group>, Bridgewater B, Liu Q <etal>et al</etal> &#160;<article-title>High resolution mass spectrometry improves data quantity and quality as compared to unit mass resolution mass spectrometry in high-throughput profiling metabolomics</article-title>. <source>Metabolomics</source> &#160;<year>2014</year>;<volume>4</volume>:<fpage>132</fpage>. <pub-id pub-id-type="doi">10.4172/2153-0769.1000132</pub-id></mixed-citation></ref><ref id="btaf065-B12"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name name-style="western"><surname>Gamelin</surname><given-names>TW</given-names></string-name>, <string-name name-style="western"><surname>Greene</surname><given-names>RE.</given-names></string-name></person-group> &#160;<italic toggle="yes">Introduction to Topology</italic>. <edition>2nd edn</edition>. New York, US: <publisher-name>Dover Publications</publisher-name>, <year>1999</year>.</mixed-citation></ref><ref id="btaf065-B13"><mixed-citation publication-type="other"><person-group person-group-type="author"><string-name name-style="western"><surname>Gan</surname><given-names>G, Ma C, Wu J.</given-names></string-name></person-group> &#160;<italic toggle="yes">Data clustering: theory, algorithms, and applications</italic>. Philadelphia, US: Society for Industrial and Applied Mathematics, 2007.</mixed-citation></ref><ref id="btaf065-B14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Gough</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Stern</surname><given-names>AM</given-names></string-name>, <string-name name-style="western"><surname>Maier</surname><given-names>J</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Biologically relevant heterogeneity: metrics and practical insights</article-title>. <source>SLAS Discov</source> &#160;<year>2017</year>;<volume>22</volume>:<fpage>213</fpage>&#8211;<lpage>37</lpage>.<pub-id pub-id-type="pmid">28231035</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1177/2472555216682725</pub-id><pub-id pub-id-type="pmcid">PMC5464733</pub-id></mixed-citation></ref><ref id="btaf065-B15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Gu</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Al Dubayee</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Alshahrani</surname><given-names>A</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Distinctive metabolomics patterns associated with insulin resistance and type 2 diabetes mellitus</article-title>. <source>Front Mol Biosci</source> &#160;<year>2020</year>;<volume>7</volume>:<fpage>609806</fpage>.<pub-id pub-id-type="pmid">33381523</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3389/fmolb.2020.609806</pub-id><pub-id pub-id-type="pmcid">PMC7768025</pub-id></mixed-citation></ref><ref id="btaf065-B16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Hasan</surname><given-names>MR</given-names></string-name>, <string-name name-style="western"><surname>Suleiman</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>P&#233;rez-L&#243;pez</surname><given-names>A</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Metabolomics in the diagnosis and prognosis of COVID-19</article-title>. <source>Front Genet</source> &#160;<year>2021</year>;<volume>12</volume>:<fpage>721556</fpage>.<pub-id pub-id-type="pmid">34367265</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3389/fgene.2021.721556</pub-id><pub-id pub-id-type="pmcid">PMC8343128</pub-id></mixed-citation></ref><ref id="btaf065-B18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Julkunen</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Cicho&#324;ska</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Tiainen</surname><given-names>M</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Atlas of plasma NMR biomarkers for health and disease in 118,461 individuals from the UK biobank</article-title>. <source>Nat Commun</source> &#160;<year>2023</year>;<volume>14</volume>:<fpage>604</fpage>&#8211;<lpage>15</lpage>.<pub-id pub-id-type="pmid">36737450</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41467-023-36231-7</pub-id><pub-id pub-id-type="pmcid">PMC9898515</pub-id></mixed-citation></ref><ref id="btaf065-B19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Julkunen</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Cicho&#324;ska</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Slagboom</surname><given-names>PE</given-names></string-name></person-group> &#160;<etal>et al</etal>; <collab>Nightingale Health UK Biobank Initiative</collab>. <article-title>Metabolic biomarker profiling for identification of susceptibility to severe pneumonia and COVID-19 in the general population</article-title>. <source>Elife</source> &#160;<year>2021</year>;<volume>10</volume>:<fpage>e63033</fpage>.<pub-id pub-id-type="pmid">33942721</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.7554/eLife.63033</pub-id><pub-id pub-id-type="pmcid">PMC8172246</pub-id></mixed-citation></ref><ref id="btaf065-B41"><mixed-citation publication-type="other"><collab>King's College London. </collab><italic toggle="yes">TwinsUK. </italic> &#160;<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://twinsuk.ac.uk/" ext-link-type="uri">https://twinsuk.ac.uk/</ext-link> (2 May 2024, date last accessed).</mixed-citation></ref><ref id="btaf065-B20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Kirk</surname><given-names>RE.</given-names></string-name></person-group> &#160;<article-title>Effect size measures</article-title>. <source>Encyclopedia Stat Behav Sci</source> &#160;<year>2005</year>;<volume>2</volume>:<fpage>532</fpage>&#8211;<lpage>42</lpage>.</mixed-citation></ref><ref id="btaf065-B21"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name name-style="western"><surname>Lash</surname><given-names>TL, Rothman KJ, VanderWeele TJ</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<source>Modern Epidemiology</source>. <edition>4th edn</edition>. <publisher-loc>Philadelphia</publisher-loc>: <publisher-name>Wolters Kluwer</publisher-name>, <year>2021</year>.</mixed-citation></ref><ref id="btaf065-B7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Le Chatelier</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Nielsen</surname><given-names>T</given-names></string-name>, <string-name name-style="western"><surname>Qin</surname><given-names>J</given-names></string-name></person-group> &#160;<etal>et al</etal>; <collab>MetaHIT Consortium</collab>. <article-title>Richness of human gut microbiome correlates with metabolic markers</article-title>. <source>Nature</source> &#160;<year>2013</year>;<volume>500</volume>:<fpage>541</fpage>&#8211;<lpage>6</lpage>.<pub-id pub-id-type="pmid">23985870</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/nature12506</pub-id></mixed-citation></ref><ref id="btaf065-B22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Leek</surname><given-names>JT</given-names></string-name>, <string-name name-style="western"><surname>Scharpf</surname><given-names>RB</given-names></string-name>, <string-name name-style="western"><surname>Bravo</surname><given-names>HC</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat Rev Genet</source> &#160;<year>2010</year>;<volume>11</volume>:<fpage>733</fpage>&#8211;<lpage>9</lpage>.<pub-id pub-id-type="pmid">20838408</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/nrg2825</pub-id><pub-id pub-id-type="pmcid">PMC3880143</pub-id></mixed-citation></ref><ref id="btaf065-B23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Lynch</surname><given-names>SV</given-names></string-name>, <string-name name-style="western"><surname>Pedersen</surname><given-names>O.</given-names></string-name></person-group> &#160;<article-title>The human intestinal microbiome in health and disease</article-title>. <source>N Engl J Med</source> &#160;<year>2016</year>;<volume>375</volume>:<fpage>2369</fpage>&#8211;<lpage>79</lpage>.<pub-id pub-id-type="pmid">27974040</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1056/NEJMra1600266</pub-id></mixed-citation></ref><ref id="btaf065-B24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Mar&#237;n-Corral</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Rodr&#237;guez-Morat&#243;</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Gomez-Gomez</surname><given-names>A</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Metabolic signatures associated with severity in hospitalized covid-19 patients</article-title>. <source>Int J Mol Sci</source> &#160;<year>2021</year>;<volume>22</volume>:<fpage>4794</fpage>.<pub-id pub-id-type="pmid">33946479</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.3390/ijms22094794</pub-id><pub-id pub-id-type="pmcid">PMC8124482</pub-id></mixed-citation></ref><ref id="btaf065-B25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Mc Auley</surname><given-names>MT.</given-names></string-name></person-group> &#160;<article-title>Effects of obesity on cholesterol metabolism and its implications for healthy ageing</article-title>. <source>Nutr Res Rev</source> &#160;<year>2020</year>;<volume>33</volume>:<fpage>121</fpage>&#8211;<lpage>33</lpage>.<pub-id pub-id-type="pmid">31983354</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1017/S0954422419000258</pub-id></mixed-citation></ref><ref id="btaf065-B26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Mendez</surname><given-names>KM</given-names></string-name>, <string-name name-style="western"><surname>Reinke</surname><given-names>SN</given-names></string-name>, <string-name name-style="western"><surname>Broadhurst</surname><given-names>DI</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>A comparative evaluation of the generalised predictive ability of eight machine learning algorithms across ten clinical metabolomics data sets for binary classification</article-title>. <source>Metabolomics</source> &#160;<year>2019</year>;<volume>15</volume>:<fpage>150</fpage>.<pub-id pub-id-type="pmid">31728648</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1007/s11306-019-1612-4</pub-id><pub-id pub-id-type="pmcid">PMC6856029</pub-id></mixed-citation></ref><ref id="btaf065-B28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Misra</surname><given-names>BB</given-names></string-name>, <string-name name-style="western"><surname>Langefeld</surname><given-names>CD</given-names></string-name>, <string-name name-style="western"><surname>Olivier</surname><given-names>M</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Integrated omics: tools, advances and future approaches</article-title>. <source>J Mol Endocrinol</source> &#160;<year>2018</year>;<volume>62</volume>:<fpage>R21</fpage>&#8211;<lpage>45</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1530/JME-18-0055</pub-id><pub-id pub-id-type="pmid">30006342</pub-id></mixed-citation></ref><ref id="btaf065-B29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Pedersen</surname><given-names>HK</given-names></string-name>, <string-name name-style="western"><surname>Forslund</surname><given-names>SK</given-names></string-name>, <string-name name-style="western"><surname>Gudmundsdottir</surname><given-names>V</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>A computational framework to integrate high-throughput &#8216;-omics&#8217; datasets for the identification of potential mechanistic links</article-title>. <source>Nat Protoc</source> &#160;<year>2018</year>;<volume>13</volume>:<fpage>2781</fpage>&#8211;<lpage>800</lpage>.<pub-id pub-id-type="pmid">30382244</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41596-018-0064-z</pub-id></mixed-citation></ref><ref id="btaf065-B30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Pedersen</surname><given-names>HK</given-names></string-name>, <string-name name-style="western"><surname>Gudmundsdottir</surname><given-names>V</given-names></string-name>, <string-name name-style="western"><surname>Nielsen</surname><given-names>HB</given-names></string-name></person-group> &#160;<etal>et al</etal>; <collab>MetaHIT Consortium</collab>. <article-title>Human gut microbes impact host serum metabolome and insulin sensitivity</article-title>. <source>Nature</source> &#160;<year>2016</year>;<volume>535</volume>:<fpage>376</fpage>&#8211;<lpage>81</lpage>.<pub-id pub-id-type="pmid">27409811</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/nature18646</pub-id></mixed-citation></ref><ref id="btaf065-B31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Pepe</surname><given-names>MS</given-names></string-name>, <string-name name-style="western"><surname>Whitaker</surname><given-names>RC</given-names></string-name>, <string-name name-style="western"><surname>Seidel</surname><given-names>K.</given-names></string-name></person-group> &#160;<article-title>Estimating and comparing univariate associations with application to the prediction of adult obesity</article-title>. <source>Statist Med</source> &#160;<year>1999</year>;<volume>18</volume>:<fpage>163</fpage>&#8211;<lpage>73</lpage>. <pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/(SICI)1097-0258(19990130)18:2&amp;#x0003c;163::AID-SIM11&amp;#x0003e;3.0.CO;2-F</pub-id><pub-id pub-id-type="pmid">10028137</pub-id></mixed-citation></ref><ref id="btaf065-B32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Roberts</surname><given-names>LD</given-names></string-name>, <string-name name-style="western"><surname>Koulman</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Griffin</surname><given-names>JL</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Towards metabolic biomarkers of insulin resistance and type 2 diabetes: progress from the metabolome</article-title>. <source>Lancet Diabetes Endocrinol</source> &#160;<year>2014</year>;<volume>2</volume>:<fpage>65</fpage>&#8211;<lpage>75</lpage>.<pub-id pub-id-type="pmid">24622670</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/S2213-8587(13)70143-8</pub-id></mixed-citation></ref><ref id="btaf065-B33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Rousseeuw</surname><given-names>PJ.</given-names></string-name></person-group> &#160;<article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J Comput Appl Math</source> &#160;<year>1987</year>;<volume>20</volume>:<fpage>53</fpage>&#8211;<lpage>65</lpage>.</mixed-citation></ref><ref id="btaf065-B34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Shin</surname><given-names>S-Y</given-names></string-name>, <string-name name-style="western"><surname>Fauman</surname><given-names>EB</given-names></string-name>, <string-name name-style="western"><surname>Petersen</surname><given-names>A-K</given-names></string-name></person-group> &#160;<etal>et al</etal>; <collab>Multiple Tissue Human Expression Resource (MuTHER) Consortium</collab>. <article-title>An atlas of genetic influences on human blood metabolites</article-title>. <source>Nat Genet</source> &#160;<year>2014</year>;<volume>46</volume>:<fpage>543</fpage>&#8211;<lpage>50</lpage>.<pub-id pub-id-type="pmid">24816252</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/ng.2982</pub-id><pub-id pub-id-type="pmcid">PMC4064254</pub-id></mixed-citation></ref><ref id="btaf065-B35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Sindelar</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Stancliffe</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Schwaiger-Haber</surname><given-names>M</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Longitudinal metabolomics of human plasma reveals prognostic markers of COVID-19 disease severity</article-title>. <source>Cell Rep Med</source> &#160;<year>2021</year>;<volume>2</volume>:<fpage>100369</fpage>.<pub-id pub-id-type="pmid">34308390</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.xcrm.2021.100369</pub-id><pub-id pub-id-type="pmcid">PMC8292035</pub-id></mixed-citation></ref><ref id="btaf065-B36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Soininen</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Kangas</surname><given-names>AJ</given-names></string-name>, <string-name name-style="western"><surname>W&#252;rtz</surname><given-names>P</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>High-throughput serum NMR metabonomics for cost-effective holistic studies on systemic metabolism</article-title>. <source>Analyst</source> &#160;<year>2009</year>;<volume>134</volume>:<fpage>1781</fpage>&#8211;<lpage>5</lpage>.<pub-id pub-id-type="pmid">19684899</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1039/b910205a</pub-id></mixed-citation></ref><ref id="btaf065-B37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Steves</surname><given-names>CJ</given-names></string-name>, <string-name name-style="western"><surname>Spector</surname><given-names>TD</given-names></string-name>, <string-name name-style="western"><surname>Jackson</surname><given-names>SHD</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Ageing, genes, environment and epigenetics: what twin studies tell us now, and in the future</article-title>. <source>Age Ageing</source> &#160;<year>2012</year>;<volume>41</volume>:<fpage>581</fpage>&#8211;<lpage>6</lpage>.<pub-id pub-id-type="pmid">22826292</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1093/ageing/afs097</pub-id></mixed-citation></ref><ref id="btaf065-B38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Suhre</surname><given-names>K</given-names></string-name>, <string-name name-style="western"><surname>McCarthy</surname><given-names>MI</given-names></string-name>, <string-name name-style="western"><surname>Schwenk</surname><given-names>JM</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Genetics meets proteomics: perspectives for large population-based studies</article-title>. <source>Nat Rev Genet</source> &#160;<year>2021</year>;<volume>22</volume>:<fpage>19</fpage>&#8211;<lpage>37</lpage>.<pub-id pub-id-type="pmid">32860016</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41576-020-0268-2</pub-id></mixed-citation></ref><ref id="btaf065-B39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Suthahar</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Sharma</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Hart</surname><given-names>D</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>TwinsUK COVID-19 personal experience questionnaire (CoPE): wave 1 data capture April-May 2020</article-title>. <source>Wellcome Open Res</source> &#160;<year>2021</year>;<volume>6</volume>:<fpage>123</fpage>.</mixed-citation></ref><ref id="btaf065-B40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Walther</surname><given-names>G</given-names></string-name>, <string-name name-style="western"><surname>Hastie</surname><given-names>T</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>. <source>J R Stat Soc Series B Stat Methodol</source> &#160;<year>2001</year>;<volume>63</volume>:<fpage>411</fpage>&#8211;<lpage>23</lpage>.</mixed-citation></ref><ref id="btaf065-B42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Uffelmann</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Huang</surname><given-names>QQ</given-names></string-name>, <string-name name-style="western"><surname>Munung</surname><given-names>NS</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Genome-wide association studies</article-title>. <source>Nat Rev Methods Primers</source> &#160;<year>2021</year>;<volume>1</volume>:<fpage>1</fpage>&#8211;<lpage>21</lpage>.</mixed-citation></ref><ref id="btaf065-B43"><mixed-citation publication-type="other"><person-group person-group-type="author"><string-name name-style="western"><surname>Willmott</surname><given-names>P.</given-names></string-name></person-group> &#160;<italic toggle="yes">Machine Learning: an Applied Mathematics Introduction.</italic> UK: Panda Ohana, 2019.</mixed-citation></ref><ref id="btaf065-B44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>W&#252;rtz</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Kangas</surname><given-names>AJ</given-names></string-name>, <string-name name-style="western"><surname>Soininen</surname><given-names>P</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Quantitative serum nuclear magnetic resonance metabolomics in Large-Scale epidemiology: a primer on -omic technologies</article-title>. <source>Am J Epidemiol</source> &#160;<year>2017</year>;<volume>186</volume>:<fpage>1084</fpage>&#8211;<lpage>96</lpage>.<pub-id pub-id-type="pmid">29106475</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1093/aje/kwx016</pub-id><pub-id pub-id-type="pmcid">PMC5860146</pub-id></mixed-citation></ref><ref id="btaf065-B45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Zierer</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Menni</surname><given-names>C</given-names></string-name>, <string-name name-style="western"><surname>Kastenm&#252;ller</surname><given-names>G</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Integration of &#8216;omics&#8217; data in aging research: from biomarkers to systems biology</article-title>. <source>Aging Cell</source> &#160;<year>2015</year>;<volume>14</volume>:<fpage>933</fpage>&#8211;<lpage>44</lpage>.<pub-id pub-id-type="pmid">26331998</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1111/acel.12386</pub-id><pub-id pub-id-type="pmcid">PMC4693464</pub-id></mixed-citation></ref></ref-list></back></article></pmc-articleset>