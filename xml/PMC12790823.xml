<?xml version="1.0"  ?><!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd"><pmc-articleset><article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xml:lang="en" article-type="research-article" dtd-version="1.4"><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="pmc-domain-id">716</journal-id><journal-id journal-id-type="pmc-domain">bioinfo</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">PMC12790823</article-id><article-id pub-id-type="pmcid-ver">PMC12790823.1</article-id><article-id pub-id-type="pmcaid">12790823</article-id><article-id pub-id-type="pmcaiid">12790823</article-id><article-id pub-id-type="pmid">41212773</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btaf619</article-id><article-id pub-id-type="publisher-id">btaf619</article-id><article-version article-version-type="pmc-version">1</article-version><article-categories><subj-group subj-group-type="heading"><subject>Original Paper</subject><subj-group subj-group-type="category-toc-heading"><subject>Data and Text Mining</subject></subj-group></subj-group><subj-group subj-group-type="category-taxonomy-collection"><subject>AcademicSubjects/SCI01060</subject></subj-group></article-categories><title-group><article-title>STAHD: a scalable and accurate method to detect spatial domains in high-resolution spatial transcriptomics data</article-title></title-group><contrib-group><contrib contrib-type="author"><name name-style="western"><surname>Du</surname><given-names initials="Z">Zhihua</given-names></name><aff>
<institution>College of Computer Science and Software Engineering, ShenZhen University</institution>, Shenzhen, Guangdong, 518000, <country country="CN">China</country></aff><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="lead">Formal analysis</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role></contrib><contrib contrib-type="author"><name name-style="western"><surname>Wang</surname><given-names initials="D">Di</given-names></name><aff>
<institution>College of Computer Science and Software Engineering, ShenZhen University</institution>, Shenzhen, Guangdong, 518000, <country country="CN">China</country></aff><aff>
<institution>Dongguan Key Laboratory for AI and Dynamical Systems, School of Computing and Information Technology, Great Bay University</institution>, Dongguan, Guangdong, 523000, <country country="CN">China</country></aff><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0005-0897-2343</contrib-id><name name-style="western"><surname>Chen</surname><given-names initials="Q">Qiyi</given-names></name><aff>
<institution>College of Computer Science and Software Engineering, ShenZhen University</institution>, Shenzhen, Guangdong, 518000, <country country="CN">China</country></aff><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0009-0008-5440-4584</contrib-id><name name-style="western"><surname>Ou</surname><given-names initials="Y">Yuehua</given-names></name><aff>
<institution>College of Computer Science and Software Engineering, ShenZhen University</institution>, Shenzhen, Guangdong, 518000, <country country="CN">China</country></aff><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role></contrib><contrib contrib-type="author"><name name-style="western"><surname>Huang</surname><given-names initials="X">Xinlei</given-names></name><aff>
<institution>Dongguan Key Laboratory for AI and Dynamical Systems, School of Computing and Information Technology, Great Bay University</institution>, Dongguan, Guangdong, 523000, <country country="CN">China</country></aff><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="equal">Visualization</role></contrib><contrib contrib-type="author" corresp="yes"><name name-style="western"><surname>Zhou</surname><given-names initials="X">Xiang</given-names></name><aff>
<institution>Guangdong Institute of Intelligence Science and Technology</institution>, <addr-line>Hengqin</addr-line>, Zhuhai, Guangdong, 519031, <country country="CN">China</country></aff><xref rid="btaf619-cor1" ref-type="corresp"/><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="lead">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="lead">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Resources" vocab-term-identifier="https://credit.niso.org/contributor-roles/resources" degree-contribution="lead">Resources</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="lead">Validation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2322-857X</contrib-id><name name-style="western"><surname>Zheng</surname><given-names initials="X">Xubin</given-names></name><aff>
<institution>Dongguan Key Laboratory for AI and Dynamical Systems, School of Computing and Information Technology, Great Bay University</institution>, Dongguan, Guangdong, 523000, <country country="CN">China</country></aff><xref rid="btaf619-cor1" ref-type="corresp"/><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="lead">Conceptualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="lead">Methodology</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="lead">Project administration</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="lead">Writing - original draft</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="lead">Writing - review &amp; editing</role></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name name-style="western"><surname>Wren</surname><given-names initials="J">Jonathan</given-names></name><role>Associate Editor</role></contrib></contrib-group><author-notes><corresp id="btaf619-cor1">Corresponding authors. Xubin Zheng, School of Information Science and Technology, Great Bay University, Daxue Road, Songshan Lake High-tech Zone, Dongguan, Guangdong, 523000, China. E-mail: <email>xbzheng@gbu.edu.cn</email>; Xiang Zhou, Guangdong Institute of Intelligence Science and Technology, 515 North Huandao Road, Hengqin Guangdong-Macao In-Depth Cooperation Zone, Zhuhai, Guangdong, 519031, China. E-mail: <email>zhouxiang2@gdiist.cn</email>.</corresp></author-notes><pub-date pub-type="collection"><month>1</month><year>2026</year></pub-date><pub-date pub-type="epub" iso-8601-date="2025-11-10"><day>10</day><month>11</month><year>2025</year></pub-date><volume>42</volume><issue>1</issue><issue-id pub-id-type="pmc-issue-id">503658</issue-id><elocation-id>btaf619</elocation-id><history><date date-type="received"><day>24</day><month>7</month><year>2025</year></date><date date-type="rev-recd"><day>20</day><month>10</month><year>2025</year></date><date date-type="accepted"><day>26</day><month>10</month><year>2025</year></date><date date-type="corrected-typeset"><day>11</day><month>1</month><year>2026</year></date></history><pub-history><event event-type="pmc-release"><date><day>10</day><month>11</month><year>2025</year></date></event><event event-type="pmc-live"><date><day>12</day><month>01</month><year>2026</year></date></event><event event-type="pmc-last-change"><date iso-8601-date="2026-01-12 10:25:14.837"><day>12</day><month>01</month><year>2026</year></date></event></pub-history><permissions><copyright-statement>&#169; The Author(s) 2025. Published by Oxford University Press.</copyright-statement><copyright-year>2025</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" content-type="pmc-pdf" xlink:href="btaf619.pdf"/><self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="btaf619.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Spatial transcriptomics (ST) enables the study of spatial heterogeneity in tissues. However, current methods struggle with large-scale, high-resolution data, leading to reduced efficiency and accuracy in detecting spatial domains. A scalable, precise solution is urgently needed.</p></sec><sec id="s2"><title>Results</title><p>We present STAHD, a scalable and efficient framework for spatial domain detection in ST data. Combining a graph attention autoencoder with multilevel <italic toggle="yes">k</italic>-way graph partitioning, STAHD decomposes large graphs into compact subgraphs and generates low-dimensional embeddings. This improves computational efficiency and clustering accuracy. Benchmarks on human and mouse datasets show STAHD outperforms existing methods and accurately reveals spatially distinct tumor microenvironments and functional regions.</p></sec><sec id="s3"><title>Availability and implementation</title><p>Source code and data are available at: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/Little-Eel/STAHD" ext-link-type="uri">https://github.com/Little-Eel/STAHD</ext-link>.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><institution-wrap><institution>National Key R&amp;D Program of China</institution><institution-id institution-id-type="DOI">10.13039/501100012166</institution-id></institution-wrap></funding-source><award-id>2020YFA0908700</award-id></award-group><award-group award-type="grant"><funding-source><institution-wrap><institution>National Natural Science Foundation of China</institution><institution-id institution-id-type="DOI">10.13039/501100001809</institution-id></institution-wrap></funding-source><award-id>32300554</award-id><award-id>62176164</award-id></award-group></funding-group><counts><page-count count="13"/></counts><custom-meta-group><custom-meta><meta-name>pmc-status-qastatus</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>pmc-status-live</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-status-embargo</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-status-released</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-open-access</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-olf</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-manuscript</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-legally-suppressed</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-pdf</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-supplement</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-pdf-only</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-suppress-copyright</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-real-version</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-scanned-article</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-preprint</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-in-epmc</meta-name><meta-value>yes</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec><title>1 Introduction</title><p>Next-generation spatially resolved transcriptomics technologies are rapidly advancing toward high-resolution platforms such as 10x Visium-HD (<xref rid="btaf619-B26" ref-type="bibr">Oliveira <italic toggle="yes">et al.</italic> 2025</xref>), 10x Xenium (<xref rid="btaf619-B36" ref-type="bibr">Xenium In Situ Platform 2024</xref>), and CosMx (<xref rid="btaf619-B12" ref-type="bibr">He <italic toggle="yes">et al.</italic> 2022</xref>), which enable subcellular resolution. This advance has led to a substantial increase in data volume, with single-section datasets reaching millions of capture spots in recent studies (<xref rid="btaf619-B17" ref-type="bibr">Kukanja <italic toggle="yes">et al.</italic> 2024</xref>, <xref rid="btaf619-B21" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2025</xref>, <xref rid="btaf619-B26" ref-type="bibr">Oliveira <italic toggle="yes">et al.</italic> 2025</xref>). As a result, new computational challenges arise in accurately delineating spatial tissue architecture and identifying spatially specific gene expression patterns (<xref rid="btaf619-B13" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2024</xref>, <xref rid="btaf619-B37" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2025</xref>).</p><p>Existing spatial domain detection methods, such as SEDR (<xref rid="btaf619-B39" ref-type="bibr">Xu <italic toggle="yes">et al.</italic> 2024</xref>), STAGATE (<xref rid="btaf619-B7" ref-type="bibr">Dong and Zhang 2022</xref>), SpaceFlow (<xref rid="btaf619-B28" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2022</xref>), and GraphST (<xref rid="btaf619-B22" ref-type="bibr">Long <italic toggle="yes">et al.</italic> 2023</xref>), face challenges in scalability and clustering accuracy due to the rapidly increasing size of high-resolution ST datasets (<xref rid="btaf619-B6" ref-type="bibr">Covert <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btaf619-B43" ref-type="bibr">Zhu <italic toggle="yes">et al.</italic> 2024</xref>). They typically require loading the entire spatial neighbor graph into memory, resulting in high computational burden when processing million-cell-scale data. Furthermore, existing approaches have limited the capacity in modeling complex spatial interactions and technical noise, especially at domain boundaries. These limitations severely constrain the potential applications of high-resolution ST data in dissecting tissue heterogeneity (<xref rid="btaf619-B38" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2024</xref>, <xref rid="btaf619-B41" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2024</xref>, <xref rid="btaf619-B40" ref-type="bibr">2021</xref>, <xref rid="btaf619-B24" ref-type="bibr">Meng <italic toggle="yes">et al.</italic> 2024</xref>).</p><p>To address these challenges, we propose STAHD, a scalable algorithm for spatial domain detection in high-resolution ST data (<xref rid="btaf619-F1" ref-type="fig">Fig.&#160;1</xref>). STAHD employs a graph attention autoencoder to integrate spatial coordinates and gene expression, learning low-dimensional embeddings for spatial domain identification. An attention mechanism adaptively models spatial similarity, particularly at domain boundaries. To reduce computational burden, we leverage a multilevel <italic toggle="yes">k</italic>-way graph partitioning strategy to recursively divide large graphs into compact subgraphs for independent training, enabling efficient processing of million-cell-scale datasets. STAHD was validated on diverse ST datasets from multiple platforms including 10x Visium (DLPFC), Visium-HD (human tonsil and human breast cancer), Xenium (whole adult mouse), and CosMx (human lymph node), and consistently outperformed existing methods in distinguishing tissue structures and computational resource consuming.</p><fig position="float" id="btaf619-F1" orientation="portrait"><label>Figure 1.</label><caption><p>Overview of STAHD. (a) Schematic workflow of STAHD. Inputs: a gene expression matrix and spatial coordinates. Processing steps: (i) normalization and selection of highly variable genes; (ii) construction of a spatial neighbor graph; (iii) multi-level <italic toggle="yes">k</italic>-way partitioning with coarsening and refinement to divide the graph into subgraphs; (iv) graph attention autoencoder for mini-batch training and latent representation learning; and (v) reconstruction of input features and optimization via reconstruction loss. Outputs: spatially informed low-dimensional embeddings that preserve both gene expression and spatial structure while reducing computational overhead. (b) STAHD generates low-dimensional embeddings for visualization and clustering of high-resolution spatial transcriptomic data, while performing data denoising and enabling scalable analysis on tissue sections containing millions of spatial spots.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf619f1.jpg"/></fig></sec><sec><title>2 Materials and methods</title><sec><title>2.1 Datasets</title><p>To train and evaluate the applicability and performance of STAHD across diverse tissue architectures and spatial resolutions, five high-resolution spatial transcriptomics (ST) datasets generated from different sequencing platforms and tissue types were used in this study. Details and the preprocessing procedures of the datasets can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary File 1</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online.</p></sec><sec><title>2.2 Spatial neighborhood graph construction</title><p>Based on the spatial coordinates of all capture spots, pairwise Euclidean distances were computed to quantify spatial proximity. Two spots were considered spatial neighbors if the distance between them was smaller than a predefined threshold <italic toggle="yes">r</italic>, which can be adjusted accordingly. According to these spatial neighborhood relationships, an undirected spatial neighbor graph was constructed and represented by an adjacency matrix <italic toggle="yes">A</italic>, where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>&#8201;=&#8201;1 if an edge exists between spot <italic toggle="yes">i</italic> and spot <italic toggle="yes">j</italic>, and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> otherwise. Additionally, self-loop edges were added to each spot to preserve the self-information of each node during subsequent graph neural network computations. To ensure consistency across datasets with different spatial resolutions, STAHD employs an adaptive radius-selection module that automatically determines the spatial radius (<italic toggle="yes">r</italic>) based on each dataset&#8217;s resolution. The spatial radius <italic toggle="yes">r</italic> represents the physical distance used to define neighborhood relationships among spots and determines the number of neighboring spots, we evaluated model performance with respect to the average neighbor count, which provides a more interpretable measure of the effective neighborhood size. Sensitivity analysis on the DLPFC dataset (<xref rid="btaf619-F1" ref-type="fig">Fig.&#160;1c</xref> and d, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online) showed that clustering performance was optimal when each spot had approximately 10&#8211;30 neighbors, achieving a balance between capturing spatial context and reducing noise. For other datasets, <italic toggle="yes">r</italic> was automatically adjusted to maintain this neighbor range, ensuring biologically meaningful and consistent spatial connectivity across spatial platforms. This strategy follows the design adopted by STAligner (<xref rid="btaf619-B42" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2023</xref>), ensuring cross-platform consistency in physical distance scaling.</p></sec><sec><title>2.3 Multilevel <italic toggle="yes">k</italic>-way graph partitioning strategy</title><p>To enable efficient analysis of large-scale ST graph data, this study leverages a multilevel <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>-way graph partitioning strategy with graph neural networks. This approach progressively simplifies the original large graph, performs an initial partitioning, and subsequently refines the partitions, thereby decomposing million-node graphs into multiple structurally compact and load-balanced subgraphs for parallel training. This significantly reduces the computational complexity per training iteration. Specifically, let the original graph be denoted as <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the set of nodes with size <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the set of unweighted edges. The edge weight function is defined as:</p><disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mi>w</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:malignmark/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>&#160;</mml:mi><mml:maligngroup/><mml:malignmark/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi>&#160;</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi>&#160;</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi>&#160;</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:malignmark/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>&#160;</mml:mi><mml:maligngroup/><mml:malignmark/><mml:mi>otherwise</mml:mi><mml:mi>&#160;</mml:mi><mml:maligngroup/><mml:malignmark/><mml:mi>&#160;</mml:mi><mml:maligngroup/><mml:malignmark/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mi>&#160;</mml:mi></mml:math></disp-formula><p>All nodes were initially assigned a uniform weight of 1, i.e. <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>w</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> for all <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>v</mml:mi><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. To address the computational challenges posed by large-scale graph partitioning, this method consists of three sequential stages: graph coarsening, initial partitioning, and multilevel refinement through uncoarsening.</p><sec><title>2.3.1 Graph coarsening</title><p>In the multilevel graph partitioning framework, the original graph <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula> is progressively compressed into a series of coarsened graphs <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with decreasing sizes. In each coarsening step, the algorithm randomly iterates over all unmatched nodes in the current graph. For each unmatched node <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi>u</mml:mi></mml:math></inline-formula>, one of its unmatched neighboring nodes <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi>v</mml:mi></mml:math></inline-formula> is randomly selected, and the two are merged into a supernode denoted as <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>C</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>. If no unmatched neighbor exists for node <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>u</mml:mi></mml:math></inline-formula>, it is retained as an individual super node. The weight of each super node is defined as the sum of the weights of its constituent nodes:</p><disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mi>w</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">&#8721;</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#8712;</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>&#8202;</mml:mo></mml:mrow></mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mi mathvariant="normal">&#160;</mml:mi></mml:math></disp-formula><p>where <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> denotes the super node and <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>v</mml:mi></mml:math></inline-formula> represents the original nodes contained within it. All original nodes are initially assigned a weight of 1, i.e. <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>w</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. The edges between super nodes are determined based on the connections among the original nodes. Specifically, if any pair of original nodes belonging to two different supernodes are connected in the original graph, an edge is established between the corresponding super nodes in the coarsened graph.</p><p>In standard multilevel graph partitioning methods, a coarsening termination threshold <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is typically predefined. The coarsening process stops when the number of nodes in the coarsened graph <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:math></inline-formula> drops below this threshold, at which point initial partitioning is performed. The value of <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is generally chosen based on the target number of partitions <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>, computational resources, or a tradeoff between partitioning speed and accuracy, with typical values ranging from <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mn>100</mml:mn><mml:mo>&#8804;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8804;</mml:mo><mml:mn>1000</mml:mn></mml:math></inline-formula>.</p><p>In contrast, the METIS-based multilevel partitioning strategy adopted in this study employs an adaptive heuristic rule to dynamically determine the termination point of coarsening without explicitly setting a fixed <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Specifically, the algorithm automatically decides the optimal coarsened graph scale based on the graph size after each coarsening iteration, the trend of cut-edge reduction, and partition quality estimations. This ensures that the final coarse graph is sufficiently small to improve initial partitioning efficiency while avoiding excessive coarsening that would otherwise degrade partitioning accuracy.</p></sec><sec><title>2.3.2 Initial partitioning</title><p>Initial partitioning is performed on the coarsened graph <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Since the edges in the graph are unweighted (with all edge weights set to 1), the partitioning phase no longer relies on edge weights or extended subgraphs, but instead adopts a degree-based greedy growing strategy. Specifically, the algorithm begins from multiple randomly selected seed supernodes and iteratively absorbs their unpartitioned neighboring supernodes into the current subgraph. Priority is given to neighboring super nodes with higher degrees to enhance intra-subgraph connectivity and minimize the number of cut edges. To ensure balanced partition sizes, the number of partitions is determined as:</p><disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>numparts</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="&#x2308;" close="&#x2309;" separators="|"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">batchsize</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mfenced><mml:mo>&#215;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>where the batch size was set to 256 by default, but can be adjusted according to the requirements of different ST platforms and resolutions. Accordingly, the approximate capacity limit for a single subgraph is:</p><disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>cap</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">num</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="normal">parts</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mfenced open="&#x2308;" close="&#x2309;" separators="|"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">batch</mml:mi><mml:mo>_</mml:mo><mml:mi mathvariant="normal">size</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mfenced><mml:mo>&#215;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mfenced><mml:mo>&#8776;</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>256</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mn>25.6</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>Once the number of super nodes in a subgraph reaches this capacity, expansion for that subgraph stops, and the algorithm proceeds to build the next subgraph. After initial partitioning, a structurally compact and load-balanced subgraph division scheme is obtained.</p></sec><sec><title>2.3.3 Uncoarsening and refinement</title><p>After initial partitioning on the coarsened graph <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the partitioning results are progressively projected back to the original graph <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> through a series of uncoarsening steps. In each step from <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the subgraph label of each supernode is propagated to all of its constituent nodes:</p><disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>label</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi>label</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo>&#160;</mml:mo><mml:mo>&#8704;</mml:mo><mml:mi>v</mml:mi><mml:mo>&#8712;</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>To further improve partitioning quality, a local refinement procedure is applied to boundary nodes between subgraphs. Specifically, for each candidate boundary node <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>v</mml:mi></mml:math></inline-formula>, the number of cut edges connected to other subgraphs before the potential migration is computed and denoted as <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mtext>cut</mml:mtext></mml:mrow><mml:mrow><mml:mtext>before</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>. Then, the number of cut edges is recalculated under the hypothetical scenario in which node <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>v</mml:mi></mml:math></inline-formula> is migrated to a neighboring subgraph <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, denoted as <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mtext>cut</mml:mtext></mml:mrow><mml:mrow><mml:mtext>after</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>. The gain in cut reduction achieved by this migration is defined as:</p><disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">cut</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">before</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">cut</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">after</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>If <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>g</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, indicating that the migration would reduce the total number of cut edges and improve subgraph compactness, the algorithm further checks whether the target subgraph <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> satisfies the capacity constraint:</p><disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8804;</mml:mo><mml:mi>cap</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>If both conditions are met, the migration operation is performed: node <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>v</mml:mi></mml:math></inline-formula> is moved from its current subgraph to the target subgraph <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and its label is updated accordingly. This process iterates over all eligible boundary nodes, sequentially applying migrations to reduce inter-subgraph cut edges while maintaining balanced partition loads. Finally, this results in a high-quality partitioning on the original graph <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with compact, well-defined subgraph boundaries and balanced sizes, providing an optimized structural foundation for subsequent graph neural network training.</p></sec></sec><sec><title>2.4 Graph attention autoencoder</title><p>We partition the original graph into several structurally compact subgraphs with balanced node counts, serving as the basic units for model training. During training, a mini-batch loading strategy is employed, where each batch consists of multiple subgraphs. The default batch size is set to 10 (a tunable hyperparameter) to balance computational load per iteration and model convergence speed.</p><p>The encoder takes the gene expression matrix <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and the corresponding spatial adjacency matrix for each subgraph as input, where <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the number of nodes in subgraph <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mi>b</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mi>d</mml:mi></mml:math></inline-formula> is the dimensionality of gene expression features. The encoder comprises <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula> graph attention layers that iteratively extract node-level latent representations. The representation of node <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> at the <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>th layer <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula> is computed as:</p><disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#963;</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">&#8721;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&#8202;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>where <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the initial feature of node <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the trainable weight matrix at the <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>th layer, <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mi>&#963;</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>&#8901;</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula> is a nonlinear activation function, and <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the neighborhood of node <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> (including itself). The attention coefficient <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> adaptively measures the influence of neighboring node <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> on node <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>, computed as:</p><disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>&#8289;</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="true">&#8721;</mml:mo><mml:mrow><mml:mi>&#953;</mml:mi><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>&#8202;</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">xp</mml:mi><mml:mo>&#8289;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>where <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the association score between node <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> and its neighbor <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>, defined as:</p><disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:malignmark/><mml:mi>Sigmoid</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>&#8741;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mi>&#160;</mml:mi><mml:maligngroup/><mml:malignmark/><mml:mi>if</mml:mi><mml:mi>&#160;</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:malignmark/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>&#160;</mml:mi><mml:maligngroup/><mml:malignmark/><mml:mi>otherwise</mml:mi><mml:maligngroup/><mml:malignmark/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>Here, <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mo>&#8741;</mml:mo></mml:math></inline-formula> denotes vector concatenation, <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is a learnable attention vector at layer <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi mathvariant="normal">&#8868;</mml:mi></mml:math></inline-formula> indicates matrix transposition. The final <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mi>L</mml:mi></mml:math></inline-formula>th layer omits the attention mechanism and directly computes the latent embedding as:</p><disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#963;</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>The output <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is treated as the final latent representation of node <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> for downstream tasks.</p><p>The decoder is symmetric to the encoder, reversing the encoding process to reconstruct the original gene expression features. At each layer <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#8230;</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, the reconstructed representation of node <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> is:</p><disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">&#8721;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo>&#8202;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mi>&#963;</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>where <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="sans-serif">T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#945;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. The final layer reconstructs the gene expression features as:</p><disp-formula id="E13"><label>(13)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#963;</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>The output <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the reconstructed gene expression profile for node <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>.</p><p>To ensure the latent embedding preserves the information of the original gene expression data, a graph attention autoencoder structure is adopted, with the reconstruction error of the gene expression matrix as the primary optimization objective. Given the original input expression matrix <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and the subgraph structure <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, the encoder produces the latent representation <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#215;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and the decoder reconstructs it as:</p><disp-formula id="E14"><label>(14)</label><mml:math id="M14" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>where <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#215;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi>b</mml:mi><mml:mo>&#8712;</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are the decoder parameters, with <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula> as the embedding dimensionality. The training objective minimizes the mean squared reconstruction error (MSE):</p><disp-formula id="E15"><label>(15)</label><mml:math id="M15" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">recon</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">&#8721;</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:mo>&#8202;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced open="&#x2225;" close="&#x2225;" separators="|"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><p>where <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mo>&#8741;</mml:mo><mml:mo>&#8901;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>&#8741;</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the Frobenius norm. To prevent gradient explosion, gradient clipping is applied during training, limiting the gradient norm to 5. A three-layer network with an embedding dimension of 64 was implemented and optimized using the Adam optimizer with a learning rate of 0.001 and a weight decay of 1e&#8722;4. The model was trained for 1000 epochs and executed on an NVIDIA GPU.</p><p>For comparison, we adopted the official implementations of the benchmark methods [SEDR, STAGATE, SpaceFlow, GraphST, and PAST (<xref rid="btaf619-B19" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2023</xref>)] and followed their recommended or default hyperparameter settings. All methods were applied to the same preprocessed datasets under identical experimental conditions to ensure a fair and reproducible comparison. All experiments were performed on a Linux server (kernel version 6.8.0) equipped with 40 CPU cores, 503 GB of system RAM, and two NVIDIA RTX A5000 GPUs (each with 24 GB memory).</p></sec></sec><sec><title>3 Results</title><sec><title>3.1 Overview of STAHD</title><p>STAHD takes the normalized gene expression matrix and spatial coordinates of tissue sections as input, and learns latent representations by modeling both transcriptional profiles and spatial information. For each ST slice, STAHD first constructs spatial neighbor graph based on the spatial coordinates of all capture spots. This process involves computing pairwise Euclidean distances, determining neighborhood relationships using a predefined distance threshold, and subsequently constructing adjacency matrix. To enhance scalability for large-scale ST datasets, STAHD recursively divides the original graph into several locally compact and computationally balanced subgraphs as inputs using multilevel <italic toggle="yes">k</italic>-way graph partitioning. This ensures that local neighborhood structures are preserved within each partition while enabling independent and parallel training of subgraphs.</p><p>Subsequently, a graph attention autoencoder is employed to independently encode each subgraph. The encoded low-dimensional embeddings are then decoded to recover the original input features, with the reconstruction error serving as the model&#8217;s optimization objective. By minimizing the reconstruction loss, STAHD effectively captures low-dimensional representations that preserve both spatial structural context and transcriptional feature information, providing a reliable foundation for downstream analysis.</p><p>Finally, STAHD enables multiple functionalities, including spatial domain identification and visualization, data denoising, and scalable analysis for large-scale ST datasets.</p></sec><sec><title>3.2 Comparison of STAHD with four methods on 10x Visium DLPFC slice for spatial clustering</title><p>To systematically evaluate the performance of STAHD, we benchmarked it against five widely used unsupervised spatial domain detection methods: SEDR, STAGATE, SpaceFlow, GraphST, and PAST using the 10x Visium human dorsolateral prefrontal cortex (DLPFC) dataset consisting of 12 tissue sections. Manual annotations of cortical layers (layers 1&#8211;6 and white matter) were used as the gold standard for evaluation (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2a</xref>). This demonstrates that STAHD successfully balances computational efficiency with accuracy. Further quantitative analysis based on ARI, NMI, AMI, and Homogeneity across the 12 sections (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2b</xref>) confirmed that STAHD achieved the highest median ARI (0.62). In addition, <xref rid="sup1" ref-type="supplementary-material">Fig. 1</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online, provides a more comprehensive comparison across multiple metrics. The bar plots (<xref rid="sup1" ref-type="supplementary-material">Fig. 1a</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online) show that STAHD attains the overall highest or comparable scores among all benchmark methods, while the box plots (<xref rid="sup1" ref-type="supplementary-material">Fig. 1b</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online) illustrate its robust performance across datasets, characterized by higher median scores and reduced variance. Outperforming all competing methods even though they used full-graph training (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2c</xref>). To assess the statistical significance of these performance differences, pairwise Wilcoxon signed-rank tests were conducted between STAHD and each benchmark method, with <italic toggle="yes">P</italic>-values adjusted using the Benjamini&#8211;Hochberg procedure and significance thresholds set at <italic toggle="yes">P</italic>&#8201;&lt;&#8201;.05 (*), <italic toggle="yes">P</italic>&#8201;&lt;&#8201;.01 (**), and <italic toggle="yes">P</italic>&#8201;&lt;&#8201;.001 (***) (<xref rid="sup1" ref-type="supplementary-material">Table 5</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online). These results validate the superior overall performance of STAHD in terms of both accuracy and scalability. It is worth noting that ARI was computed only for the DLPFC dataset with available manual annotations, whereas for other datasets lacking ground-truth labels, performance was assessed through biological validation, including morphology, marker genes, and functional coherence.</p><fig position="float" id="btaf619-F2" orientation="portrait"><label>Figure 2.</label><caption><p>STAHD performance analysis: benchmarking on human DLPFC slices and adult mouse slice. (a) Ground-truth manual annotations of human DLPFC slices. (b) Benchmarking across 12 DLPFC slices: STAHD achieves the highest median ARI, significantly outperforming alternative methods (STAGATE, GraphST, SpaceFlow, SEDR, and PAST) based on Wilcoxon signed-rank tests. (c) Clustering results on slice 151&#160;673: STAHD achieves the best concordance with ground-truth layers (ARI&#8201;=&#8201;0.62), compared to other methods. (d) UMAP visualizations for DLPFC data section 151&#160;673, using low-dimensional embeddings from STAHD, colored by the layer annotation of spots. (e) STAHD identifies spatial domains in the xenium_whole_adult_mouse dataset, capturing diverse tissue types such as skin, muscle, lung, and brain. (f) Spatial organization substructure of some of the marked genes and visualizations of the raw spatial expressions and STAHD denoised ones in the xenium_whole_adult_mouse. (g) Heatmap of tissue-specific marker gene expression profiles in the xenium_whole_adult_mouse dataset. (h) Scalability analysis: STAHD maintains low memory usage and training time, with memory scaling sublinearly with the number of spots, outperforming other methods.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf619f2.jpg"/></fig><p>Moreover, by integrating spatial coordinates, STAHD precisely computed the relative distances between spatial domains and visualized the spatial spots via UMAP dimensionality reduction (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2d</xref>). Taking sample #151673 as an example, the UMAP projection generated from STAHD embeddings clearly depicted a hierarchical spatial gradient extending from superficial Layer 1 to deeper Layer 6 and white matter, faithfully recapitulating the anatomically ordered structure of the human cerebral cortex. This observation is highly consistent with known neurobiological principles, as adjacent cortical layers exhibit functional coupling (<xref rid="btaf619-B10" ref-type="bibr">Gilmore and Herrup 1997</xref>). We assessed the sensitivity of STAHD to subgraph size on the Xenium whole adult mouse dataset by varying the batch size parameter (512&#8211;8192). Clustering consistency across different settings was evaluated using Cram&#233;r&#8217;s V, which is robust to label permutations and does not require ground-truth annotations. As shown in <xref rid="sup1" ref-type="supplementary-material">Fig. 2a</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online, the results remained highly consistent (Cram&#233;r&#8217;s <italic toggle="yes">V</italic>&#8201;&#8776;&#8201;1), indicating that STAHD is robust to subgraph size and that varying batch size does not substantially affect spatial domain detection.</p></sec><sec><title>3.3 Spatial domain identification on the xenium whole adult mouse dataset using STAHD</title><p>STAHD was further applied to the 10x Xenium Adult Mouse Dataset, which includes 1&#160;298&#160;870 cells. The method identified major anatomical regions such as skin, muscle, skeletal areas, brain, and retina nerve tissues. It also delineated spatial domains enriched in epithelial cells, immune clusters, pulmonary endothelial, and mesenchymal cells (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2e</xref>).</p><p>To validate these domains, we examined region-specific marker genes. The clustering results showed strong consistency with known biological annotations. Notably, <italic toggle="yes">Actn2</italic> showed high expression in muscle tissue (<xref rid="btaf619-B25" ref-type="bibr">Murphy and Young 2015</xref>), <italic toggle="yes">Abcb4</italic> was significantly expressed in the liver (<xref rid="btaf619-B20" ref-type="bibr">Lipi&#324;ski <italic toggle="yes">et al.</italic> 2021</xref>), <italic toggle="yes">Akap5</italic> was enriched in the lung (<xref rid="btaf619-B18" ref-type="bibr">Lester <italic toggle="yes">et al.</italic> 1997</xref>), and <italic toggle="yes">Adcy1</italic> predominantly localized to brain regions (<xref rid="btaf619-B35" ref-type="bibr">Wong <italic toggle="yes">et al.</italic> 1999</xref>). The denoised data by STAHD revealed clearer spatial expression for markers such as <italic toggle="yes">Abcb4, Akap5</italic>, and <italic toggle="yes">Adcy1</italic>, which were fragmented in the original dataset (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2f</xref>). This demonstrates that STAHD enhances data interpretability and preserves biological signals.</p><p>We further visualized gene expression across anatomical regions using a heatmap (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2g</xref>). Region-enriched genes included <italic toggle="yes">Igf2, H19, Myh8</italic>, and <italic toggle="yes">Actn2</italic> in muscle, and <italic toggle="yes">Apoa1, Fgg</italic>, and <italic toggle="yes">Afp</italic> in liver, confirming the biological relevance of STAHD-identified domains.</p><p>STAHD also demonstrated excellent memory efficiency. It required only 2.1&#8201;GB of GPU memory to analyze over 1 million cells. As the cell number increased from 52&#160;000 to 130&#160;000, runtime increased from 4000 to 20&#160;000&#8201;s (<xref rid="btaf619-F2" ref-type="fig">Fig.&#160;2h</xref>), much lower than the expected 2.5&#215; growth. In contrast, mainstream methods failed due to out-of-memory errors. These results confirm that STAHD not only scales effectively for ultra-large spatial datasets but also maintains high analytical accuracy and stability. Although STAHD scales efficiently to large datasets, its computational efficiency is less competitive on very small datasets due to the fixed overhead of preprocessing steps such as graph coarsening and mini-batch training. For datasets with fewer than &#8764;50&#160;000 spots, traditional methods (e.g. STAGATE) are expected to run faster with comparable accuracy. In contrast, STAHD is particularly advantageous for medium-to-large-scale analyses, where it enables efficient processing of hundreds of thousands to millions of spots with substantially reduced memory usage.</p></sec><sec><title>3.4 STAHD reveals fine-scale spatial domains in human lymph node CosMx data</title><p>We applied STAHD to the CosMx human lymph node single-cell ST dataset (<xref rid="btaf619-B5" ref-type="bibr">CosMx Human Lymph Node FFPE Dataset 2025</xref>), which comprises 1&#160;852&#160;946 spots and 6520 genes, the largest available single-cell ST dataset. <xref rid="btaf619-F3" ref-type="fig">Figure&#160;3a</xref> presents the high-resolution morphological image of the tissue section, providing histological reference for subsequent spatial clustering analysis.</p><fig position="float" id="btaf619-F3" orientation="portrait"><label>Figure 3.</label><caption><p>Spatial domain delineation and cellular mapping in human lymphoid tissue using STAHD. (a) High-resolution morphological image of CosMx lymph node tissue section. (b) Spatial domains identified by STAHD reveal anatomically coherent structures. (c) Mapping of Leiden clusters and representative marker gene expression in spatial context. (d) UMAP projection shows transcriptional heterogeneity across spatial domains. (e) Top three differentially expressed genes (log<sub>2</sub> fold change) for each Leiden cluster. (f) Memory consumption scales linearly with number of cells in CosMx lymph data. (g) Runtime analysis of STAHD with increasing cellular resolution in CosMx lymph tissue.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf619f3.jpg"/></fig><p>Focusing on organ-level functional structure identification, we clustered five spatial domains. STAHD successfully delineated the germinal center, T-cell zone, activated immune cell region, stromal region, and T-cell-enriched zone (<xref rid="btaf619-F3" ref-type="fig">Fig.&#160;3b</xref>), with spatial distribution patterns highly consistent with anatomical tissue structures. Further spatial mapping analysis integrating representative marker genes, such as <italic toggle="yes">CCL21</italic> (<xref rid="btaf619-B9" ref-type="bibr">F&#246;rster <italic toggle="yes">et al.</italic> 1999</xref>), <italic toggle="yes">CD74</italic> (<xref rid="btaf619-B32" ref-type="bibr">Serviss <italic toggle="yes">et al.</italic> 2018</xref>), <italic toggle="yes">MKI67</italic> (<xref rid="btaf619-B30" ref-type="bibr">Scholzen and Gerdes 2000</xref>), and <italic toggle="yes">IL7R</italic> (<xref rid="btaf619-B23" ref-type="bibr">Mazzucchelli and Durum 2007</xref>), enabled biological functional annotation of distinct spatial domains (<xref rid="btaf619-F3" ref-type="fig">Fig.&#160;3c</xref>). The results showed strong concordance between each functional domain and the spatial enrichment of corresponding marker genes, validating STAHD&#8217;s accuracy in resolving organ architecture.</p><p>UMAP results (<xref rid="btaf619-F3" ref-type="fig">Fig.&#160;3d</xref>) show that STAHD improves the separation of spatial structures, revealing clear and distinct clusters that reflect both local and global spatial features. All UMAP visualizations were generated using a uniform Scanpy workflow with fixed parameters to ensure comparability across figures. Further analysis of cluster-specific differentially expressed genes identified the top three marker genes per cluster (<xref rid="btaf619-F3" ref-type="fig">Fig.&#160;3e</xref>), indicating unique and significant expression patterns across spatial regions. For example, <italic toggle="yes">IGFBP7</italic> (<xref rid="btaf619-B2" ref-type="bibr">Broughton <italic toggle="yes">et al.</italic> 2010</xref>) and <italic toggle="yes">CCL21</italic> (<xref rid="btaf619-B9" ref-type="bibr">F&#246;rster <italic toggle="yes">et al.</italic> 1999</xref>) were highly expressed in the lymph node stroma, <italic toggle="yes">IGHM</italic> (<xref rid="btaf619-B31" ref-type="bibr">Seifert <italic toggle="yes">et al.</italic> 2015</xref>) were enriched in the germinal center, and <italic toggle="yes">IL7R</italic> (<xref rid="btaf619-B23" ref-type="bibr">Mazzucchelli and Durum 2007</xref>) and <italic toggle="yes">TRBC2</italic> (<xref rid="btaf619-B8" ref-type="bibr">Emerson <italic toggle="yes">et al.</italic> 2017</xref>) were predominantly expressed in the T-cell zone, confirming the biological relevance of STAHD&#8217;s spatial clustering results. Functional enrichment analysis (<xref rid="sup1" ref-type="supplementary-material">Fig. 4b</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online) further revealed significant differences in immune-related pathways among spatial domains. The germinal center was predominantly enriched for B cell receptor signaling and B cell activation pathways, whereas the T-cell zone was enriched in T-cell activation and T-cell receptor signaling pathways, reflecting active immune microenvironments in distinct regions and underscoring STAHD&#8217;s utility in dissecting spatial microenvironmental heterogeneity.</p><fig position="float" id="btaf619-F4" orientation="portrait"><label>Figure 4.</label><caption><p>Spatial domain identification and biological annotation of human tonsil using STAHD. (a) Morphological image of human tonsil tissue slice captured by the 10x Visium-HD platform. (b) Spatial domain identification results obtained by STAHD, including B cell zone, crypt epithelium, germinal center, inflamed/neutrophil-rich crypt epithelium, plasma cell-rich area, subepithelial fibroblast zone, and T-cell zone. (c) Spatial expression heatmaps of representative marker genes, showing domain-specific expression patterns across different anatomical structures. (d) Stacked violin plots of marker gene expression levels in annotated spatial domains, illustrating the transcriptional heterogeneity within human tonsil tissue. (e) GO biological process enrichment analysis of the crypt epithelium domain. (f) Comparison of memory consumption for STAHD, STAGATE, GraphST, spaceflow, and SEDR on large-scale Xenium spatial transcriptomics datasets.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf619f4.jpg"/></fig><p>In terms of computational performance, STAHD demonstrated superior efficiency compared to STAGATE, GraphST, SpaceFlow, and SEDR (<xref rid="btaf619-F3" ref-type="fig">Fig.&#160;3f and g</xref>). For datasets exceeding 10&#160;000 cells, STAHD maintained an O(<italic toggle="yes">n</italic>log&#8201;<italic toggle="yes">n</italic>) time complexity, while comparative methods exhibited quadratic O(<italic toggle="yes">n</italic><sup>2</sup>) growth. Thanks to its memory-optimized design, STAHD stably completed analyses of million-cell scale single-cell ST data, avoiding common out-of-memory issues encountered by mainstream methods, and demonstrating excellent scalability and computational robustness.</p></sec><sec><title>3.5 Spatial structure identification and functional annotation of human tonsil based on STAHD</title><p>We applied the STAHD method to analyze human tonsil ST data generated by the 10x Visium-HD platform. The morphological image of the tissue section (<xref rid="btaf619-F4" ref-type="fig">Fig.&#160;4a</xref>) clearly displays the typical structural features, providing an intuitive spatial context for subsequent spatial domain segmentation and marker gene localization. We then performed spatial clustering of cellular populations within the tissue section Based on differential gene expression analysis and spatial expression patterns, we biologically annotated the resulting clusters, delineating distinct functional spatial domains and their potential biological roles within the tissue.</p><p>STAHD partitioned the tonsil tissue into seven biologically meaningful spatial microenvironments (<xref rid="btaf619-F4" ref-type="fig">Fig.&#160;4b</xref>), including naive B cell zones, crypt epithelium, germinal centers (GC B cells/FDC), inflamed/neutrophil-enriched crypt epithelium, plasma cell-enriched zones, submucosal fibroblast regions, and T-cell zones (paracortex). This spatial distribution pattern faithfully reflects the typical immune microenvironment architecture of tonsil tissue, with distinct immune cell populations exhibiting clear spatial partitioning and heterogeneity, highlighting the organ&#8217;s role as a key mucosa-associated lymphoid tissue with important immunoregulatory functions.</p><p>To further validate the accuracy of spatial domain annotations, representative marker genes were selected for spatial expression visualization (<xref rid="btaf619-F4" ref-type="fig">Fig.&#160;4c</xref>). The results show that <italic toggle="yes">IGHG1</italic> (<xref rid="btaf619-B3" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2023</xref>) is primarily expressed in the plasma cell-enriched region, <italic toggle="yes">CCL21</italic> (<xref rid="btaf619-B9" ref-type="bibr">F&#246;rster <italic toggle="yes">et al.</italic> 1999</xref>) is enriched in the T-cell zone, <italic toggle="yes">HIST1H1B</italic> (<xref rid="btaf619-B29" ref-type="bibr">Ripoll <italic toggle="yes">et al.</italic> 2008</xref>) is highly expressed in germinal centers, and <italic toggle="yes">IGHD</italic> (<xref rid="btaf619-B31" ref-type="bibr">Seifert <italic toggle="yes">et al.</italic> 2015</xref>) is mainly localized to the B cell zone. These spatially restricted expression patterns are highly consistent with histological structures, confirming the biological validity and accuracy of the STAHD-based spatial domain delineation.</p><p>Stacked violin plots (<xref rid="btaf619-F4" ref-type="fig">Fig.&#160;4d</xref>) showed distinct marker gene expression across spatial domains, such as <italic toggle="yes">IGHG1</italic> and <italic toggle="yes">IGHM</italic> in plasma cell regions, <italic toggle="yes">CCL21</italic> in the T-cell zone, and <italic toggle="yes">HIST1H1B</italic> in germinal centers, highlighting transcriptional heterogeneity. GO analysis of the crypt epithelium (<xref rid="btaf619-F4" ref-type="fig">Fig.&#160;4e</xref>) revealed enrichment in epithelial barrier and immune response processes, supporting its functional annotation.</p><p>Finally, we compared memory consumption of STAHD with other mainstream spatial omics analysis methods, including STAGATE, GraphST, SpaceFlow, and SEDR. When applied to large-scale Xenium ST data (<xref rid="btaf619-F4" ref-type="fig">Fig.&#160;4f</xref>). STAHD demonstrated consistently lower memory usage while analyzing large-scale cellular data, significantly outperforming other methods.</p></sec><sec><title>3.6 STAHD reveals complex and refined spatial structures in human breast cancer tissue through spatial clustering analysis</title><p>We applied STAHD approach to analyze human breast cancer ST data generated using the 10x Visium-HD platform, systematically exploring spatial heterogeneity within the tumor microenvironment. Breast cancer exhibits pronounced intratumoral heterogeneity, characterized by complex cellular compositions and spatial structural features (<xref rid="btaf619-B33" ref-type="bibr">Shan <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btaf619-B1" ref-type="bibr">Bai <italic toggle="yes">et al.</italic> 2024</xref>). <xref rid="btaf619-F5" ref-type="fig">Figure&#160;5a</xref> illustrates the spatial transcriptomic map of the breast cancer tissue section, with total UMI counts reflecting spatial variation in transcriptional activity and serving as the basis for spatial clustering.</p><fig position="float" id="btaf619-F5" orientation="portrait"><label>Figure 5.</label><caption><p>Spatial mapping of tissue structures and transcriptional heterogeneity in human breast cancer using STAHD. (a) High-resolution spatial transcriptomic map of a human breast cancer section, showing total UMI counts per bin to reveal spatial variation in transcriptional activity. (b) Spatial domains identified within the tissue, corresponding to distinct histological regions. (c) Distribution of Leiden clusters and key marker genes, highlighting cell type-specific spatial patterns. (d) UMAP visualization of CosMx lymphatic cells, showing transcriptional heterogeneity among immune populations. (e) Memory usage as a function of cell number for the high-resolution breast cancer dataset. (f) GO enrichment analysis of stromal vascular regions, indicating enrichment in immune-related and metabolic processes.</p></caption><graphic xmlns:xlink="http://www.w3.org/1999/xlink" position="float" orientation="portrait" xlink:href="btaf619f5.jpg"/></fig><p>We finely delineated spatial regions within the tumor tissue section (<xref rid="btaf619-F5" ref-type="fig">Fig.&#160;5b</xref>). The identified domains include the stroma (rich in fibroblasts), ductal epithelium (ER+ breast cancer cells), periductal area (HER2+ breast cancer cells), stromal vascular region (vascular smooth muscle cells), and immune infiltration region (T-cells and macrophages). The stroma primarily localizes to interstitial spaces and is fibroblast-rich; the ductal epithelium consists of clustered ER+ cancer cells surrounding glandular structures; the periductal area is dominated by HER2+ cancer cells located adjacent to ducts; the stromal vascular region is enriched in vascular smooth muscle cells near blood vessels; and the immune infiltration region mainly comprises T-cells and macrophages, frequently found at tumor margins and areas of necrosis. This spatial distribution reveals the heterogeneity and spatial organization of distinct cellular populations within breast cancer tissue, providing a foundation for dissecting tumor microenvironment cellular interactions and spatial dependency mechanisms.</p><p>We further performed differential expression analysis (<xref rid="btaf619-F5" ref-type="fig">Fig.&#160;5c</xref>), selecting representative marker genes for each spatial domain and visualizing their expression patterns. <italic toggle="yes">COL1A1</italic> (<xref rid="btaf619-B27" ref-type="bibr">Oskarsson 2013</xref>) is highly expressed in the periductal area; <italic toggle="yes">SLC39A6</italic> (<xref rid="btaf619-B34" ref-type="bibr">Taylor <italic toggle="yes">et al.</italic> 2008</xref>) predominantly localizes to the ductal epithelium; <italic toggle="yes">CD24</italic> (<xref rid="btaf619-B16" ref-type="bibr">Kristiansen <italic toggle="yes">et al.</italic> 2003</xref>) shows widespread expression in the stroma; <italic toggle="yes">MYH11</italic> (<xref rid="btaf619-B11" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>) integrated analysis of multimodal is specifically enriched in the stromal vascular region; and <italic toggle="yes">TCIM</italic> exhibits elevated expression within the immune infiltration region. The spatial expression profiles of these markers corroborate the STAHD-derived spatial annotations, further validating the accuracy of domain identification while unveiling molecular characteristics and spatial distributions of different cellular populations within the tumor tissue.</p><p>UMAP visualization (<xref rid="btaf619-F5" ref-type="fig">Fig.&#160;5d</xref>) shows that cells form distinct clusters corresponding to spatial domains, confirming alignment between spatial location and transcriptomic profiles. STAHD achieves lower memory usage than SEDR, SpaceFlow, and GraphST across various cell counts (<xref rid="btaf619-F5" ref-type="fig">Fig.&#160;5e</xref>), demonstrating superior scalability. GO enrichment analysis (<xref rid="btaf619-F5" ref-type="fig">Fig.&#160;5f</xref>) reveals that ductal epithelium is involved in angiogenesis and epithelial maintenance, while the periductal area is enriched in processes related to adhesion and metal ion regulation, supporting the functional relevance of spatial domains.</p></sec></sec><sec><title>4 Discussion</title><p>STAHD effectively mitigates high memory consumption challenges faced by traditional full-graph-based methods when analyzing ultra-large-scale ST data. On million-cell datasets generated by the Xenium platform, STAHD completes training within 4&#8201;h on a 24&#8201;GB GPU, which cannot be accomplished by mainstream methods such as STAGATE and GraphST. In contrast to other approaches, STAHD avoids holding the entire spatial neighbor graph in memory. By partitioning the graph into compact subgraphs and training them in mini-batches, STAHD prevents memory overload while preserving local structures. This strategy enables stable analysis of million-cell datasets with only 2.1&#8201;GB of GPU memory, highlighting its scalability advantage. The graph coarsening step in STAHD conceptually resembles &#8220;metacells&#8221; in single-cell analysis, as both aggregate similar units to reduce complexity. However, unlike metacell methods that group cells by molecular similarity, STAHD&#8217;s coarsening is driven by spatial adjacency and graph topology, and the coarsened units are later refined back to the original graph. These supernodes could nevertheless be explored as spatial metacells for downstream analysis in future work. At present, STAHD primarily builds adjacency graphs based on spatial proximity, without fully incorporating multimodal spatial omics data&#8212;such as histological image features, proteomics (<xref rid="btaf619-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2019</xref>), and spatial metabolomics. Expanding its integration of these modalities is a key direction for future work to enhance its ability to capture complex cross-hierarchical spatial structures. We further examined the impact of different clustering algorithms on spatial domain identification. The results demonstrated that STAHD produced generally consistent spatial structures across Leiden, <italic toggle="yes">K</italic>-means, and Mclust clustering, with only minor local variations (<xref rid="sup1" ref-type="supplementary-material">Fig. 3</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online).</p><p>In our experiments, the number of clusters was determined by dataset characteristics: seven for DLPFC (matching ground-truth annotations), and empirically chosen for others to ensure stability and biological interpretability, resulting in 13 for the Xenium mouse dataset, five for human lymph node (CosMx), seven for tonsil, and five for breast cancer tissue. From a practical perspective, because STAHD introduces additional preprocessing overhead, it is particularly suitable for medium-to-large ST datasets (hundreds of thousands to millions of spots) or in scenarios where memory constraints make full-graph training infeasible; for smaller datasets (on the order of 10<sup>4</sup> spots or fewer), existing full-graph methods may provide faster turnaround. Detailed runtime and memory usage measurements for all datasets are provided in <xref rid="sup1" ref-type="supplementary-material">Tables 1&#8211;4</xref>, available as <xref rid="sup1" ref-type="supplementary-material">supplementary data</xref> at <italic toggle="yes">Bioinformatics</italic> online, alongside the performance plots, to facilitate a direct comparison with other methods. Furthermore, as multiomics play an important role in deciphering tissues (<xref rid="btaf619-B15" ref-type="bibr">Jin <italic toggle="yes">et al.</italic> 2024</xref>), we will extend our method to spatial multiomics in the near future (<xref rid="btaf619-B14" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2025</xref>).</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="sup1" position="float" content-type="local-data" orientation="portrait"><label>btaf619_Supplementary_Data</label><media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="btaf619_supplementary_data.doc" position="float" orientation="portrait"/></supplementary-material></sec></body><back><ack id="ack1"><title>Acknowledgements</title><p>We acknowledge the support of the Guangdong Provincial Key Laboratory of Mathematical and Neural Dynamical Systems. We also acknowledge the computational resources from SongShan Lake HPC Center (SSL-HPC) in Great Bay University.</p></ack><sec><title>Author Contributions</title><p>Zhihua Du (Conceptualization [lead], Formal analysis [lead], Funding acquisition [lead], Methodology [lead], Writing&#8212;original draft [lead]), Di Wang (Data curation [equal], Formal analysis [equal], Investigation [equal], Validation [equal], Visualization [equal], Writing&#8212;original draft [equal]), Qiyi Chen (Data curation [equal], Formal analysis [equal], Investigation [equal], Methodology [equal], Validation [equal], Visualization [equal], Yuehua Ou (Data curation [equal], Validation [equal], Visualization [equal]), Xinlei Huang (Data curation [equal], Formal analysis [equal], Investigation [equal], Visualization [equal]), Xiang Zhou (Conceptualization [lead], Data curation [lead], Investigation [lead], Methodology [lead], Resources [lead], Supervision [lead], Validation [lead], Writing&#8212;review &amp; editing [lead]), Xubin Zheng (Conceptualization [lead], Funding acquisition [lead], Methodology [lead], Project administration [lead], Supervision [lead], Writing&#8212;original draft [lead], Writing&#8212;review &amp; editing [lead])</p></sec><sec><title>Supplementary data</title><p>
<xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p><p>Conflict of interest: None declared.</p></sec><sec><title>Funding</title><p>This project was supported by the National Key R&amp;D Program of China under Grant 2020YFA0908700 and the National Natural Science Foundation of China No. 32300554 and No. 62176164.</p></sec><sec sec-type="data-availability"><title>Data availability</title><p>The source code of STAHD used in this study has been archived on Zenodo (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.5281/zenodo.17214602" ext-link-type="uri">https://doi.org/10.5281/zenodo.17214602</ext-link>), corresponding to version v1.0.0 that was used to generate the results presented in this article. The latest development version is available on GitHub at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/Little-Eel/STAHD" ext-link-type="uri">https://github.com/Little-Eel/STAHD</ext-link>. All spatial transcriptomics datasets used in this study are publicly available. Detailed sources and download links are listed below: 10x Visium human dorsolateral prefrontal cortex (DLPFC) dataset and tutorials: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.2.0/V1_Human_DLPFC" ext-link-type="uri">https://support.10xgenomics.com/spatial-gene-expression/datasets/1.2.0/V1_Human_DLPFC</ext-link>. Xenium platform whole adult mouse brain dataset (xenium_whole_adult_mouse), including data and tutorials: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.10xgenomics.com/datasets/xenium-prime-ffpe-neonatal-mouse" ext-link-type="uri">https://www.10xgenomics.com/datasets/xenium-prime-ffpe-neonatal-mouse</ext-link>. CosMx SMI human lymph node dataset (Cosmx lymph) from NanoString: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://nanostring.com/products/cosmx-spatial-molecular-imager/ffpe-dataset/cosmx-human-lymph-node-ffpe-dataset/" ext-link-type="uri">https://nanostring.com/products/cosmx-spatial-molecular-imager/ffpe-dataset/cosmx-human-lymph-node-ffpe-dataset/</ext-link>. 10x Genomics Visium-HD human breast cancer dataset (FFPE-IF): <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-libraries-human-breast-cancer-ffpe-if" ext-link-type="uri">https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-libraries-human-breast-cancer-ffpe-if</ext-link>. 10x Genomics Visium-HD human tonsil dataset (fresh frozen, IF): <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-human-tonsil-fresh-frozen-if" ext-link-type="uri">https://www.10xgenomics.com/datasets/visium-hd-cytassist-gene-expression-human-tonsil-fresh-frozen-if</ext-link>.</p></sec><ref-list id="ref1"><title>References</title><ref id="btaf619-B1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Bai</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Chi</surname><given-names>K</given-names></string-name>, <string-name name-style="western"><surname>Zhao</surname><given-names>D</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Identification of functional heterogeneity of immune cells and tubular-immune cellular interplay action in diabetic kidney disease</article-title>. <source>J Transl Int Med</source> &#160;<year>2024</year>;<volume>12</volume>:<fpage>395</fpage>&#8211;<lpage>405</lpage>.<pub-id pub-id-type="pmid">39360161</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.2478/jtim-2023-0130</pub-id><pub-id pub-id-type="pmcid">PMC11444470</pub-id></mixed-citation></ref><ref id="btaf619-B2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Broughton</surname><given-names>SJ</given-names></string-name>, <string-name name-style="western"><surname>Slack</surname><given-names>C</given-names></string-name>, <string-name name-style="western"><surname>Alic</surname><given-names>N</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>DILP-producing median neurosecretory cells in the <italic toggle="yes">Drosophila</italic> brain mediate the response of lifespan to nutrition</article-title>. <source>Aging Cell</source> &#160;<year>2010</year>;<volume>9</volume>:<fpage>336</fpage>&#8211;<lpage>46</lpage>.<pub-id pub-id-type="pmid">20156206</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1111/j.1474-9726.2010.00558.x</pub-id><pub-id pub-id-type="pmcid">PMC4467032</pub-id></mixed-citation></ref><ref id="btaf619-B4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Cheng</surname><given-names>L</given-names></string-name>, <string-name name-style="western"><surname>Liu</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Wang</surname><given-names>D</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Exploiting locational and topological overlap model to identify modules in protein interaction networks</article-title>. <source>BMC Bioinformatics</source> &#160;<year>2019</year>;<volume>20</volume>:<fpage>23</fpage>.<pub-id pub-id-type="pmid">30642247</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1186/s12859-019-2598-7</pub-id><pub-id pub-id-type="pmcid">PMC6332531</pub-id></mixed-citation></ref><ref id="btaf619-B5"><mixed-citation publication-type="other"><collab>CosMx Human Lymph Node FFPE Dataset</collab>. NanoString. <year>2025</year>.</mixed-citation></ref><ref id="btaf619-B6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Covert</surname><given-names>I</given-names></string-name>, <string-name name-style="western"><surname>Gala</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Wang</surname><given-names>T</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Predictive and robust gene selection for spatial transcriptomics</article-title>. <source>Nat Commun</source> &#160;<year>2023</year>;<volume>14</volume>:<fpage>2091</fpage>.<pub-id pub-id-type="pmid">37045821</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41467-023-37392-1</pub-id><pub-id pub-id-type="pmcid">PMC10097645</pub-id></mixed-citation></ref><ref id="btaf619-B7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Dong</surname><given-names>K</given-names></string-name>, <string-name name-style="western"><surname>Zhang</surname><given-names>S.</given-names></string-name></person-group> &#160;<article-title>Deciphering spatial domains from spatially resolved transcriptomics with an adaptive graph attention auto-encoder</article-title>. <source>Nat Commun</source> &#160;<year>2022</year>;<volume>13</volume>:<fpage>1739</fpage>.<pub-id pub-id-type="pmid">35365632</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41467-022-29439-6</pub-id><pub-id pub-id-type="pmcid">PMC8976049</pub-id></mixed-citation></ref><ref id="btaf619-B8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Emerson</surname><given-names>RO</given-names></string-name>, <string-name name-style="western"><surname>DeWitt</surname><given-names>WS</given-names></string-name>, <string-name name-style="western"><surname>Vignali</surname><given-names>M</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</article-title>. <source>Nat Genet</source> &#160;<year>2017</year>;<volume>49</volume>:<fpage>659</fpage>&#8211;<lpage>65</lpage>.<pub-id pub-id-type="pmid">28369038</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/ng.3822</pub-id></mixed-citation></ref><ref id="btaf619-B9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>F&#246;rster</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Schubel</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Breitfeld</surname><given-names>D</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>CCR7 coordinates the primary immune response by establishing functional microenvironments in secondary lymphoid organs</article-title>. <source>Cell</source> &#160;<year>1999</year>;<volume>99</volume>:<fpage>23</fpage>&#8211;<lpage>33</lpage>.<pub-id pub-id-type="pmid">10520991</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/s0092-8674(00)80059-8</pub-id></mixed-citation></ref><ref id="btaf619-B10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Gilmore</surname><given-names>EC</given-names></string-name>, <string-name name-style="western"><surname>Herrup</surname><given-names>K.</given-names></string-name></person-group> &#160;<article-title>Cortical development: layers of complexity</article-title>. <source>Curr Biol</source> &#160;<year>1997</year>;<volume>7</volume>:<fpage>R231</fpage>&#8211;<lpage>4</lpage>.<pub-id pub-id-type="pmid">9162498</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/s0960-9822(06)00108-4</pub-id></mixed-citation></ref><ref id="btaf619-B11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Hao</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Hao</surname><given-names>S</given-names></string-name>, <string-name name-style="western"><surname>Andersen-Nissen</surname><given-names>E</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source> &#160;<year>2021</year>;<volume>184</volume>:<fpage>3573</fpage>&#8211;<lpage>87.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.cell.2021.04.048</pub-id><pub-id pub-id-type="pmcid">PMC8238499</pub-id></mixed-citation></ref><ref id="btaf619-B12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>He</surname><given-names>S</given-names></string-name>, <string-name name-style="western"><surname>Bhatt</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Brown</surname><given-names>C</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>High-plex imaging of RNA and proteins at subcellular resolution in fixed tissue by spatial molecular imaging</article-title>. <source>Nat Biotechnol</source> &#160;<year>2022</year>;<volume>40</volume>:<fpage>1794</fpage>&#8211;<lpage>806</lpage>.<pub-id pub-id-type="pmid">36203011</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41587-022-01483-z</pub-id></mixed-citation></ref><ref id="btaf619-B13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Huang</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Perone</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Leung</surname><given-names>KSK</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>The utility of artificial intelligence and machine learning in the diagnosis of takotsubo cardiomyopathy: a systematic review</article-title>. <source>Heart Mind</source> &#160;<year>2024</year>;<volume>8</volume>:<fpage>165</fpage>&#8211;<lpage>76</lpage>.</mixed-citation></ref><ref id="btaf619-B14"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name name-style="western"><surname>Huang</surname><given-names>X, Zhiqi M, Dian M</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<part-title>PRAGA: prototype-aware graph adaptive aggregation for spatial multi-modal omics analysis</part-title>. In: <source>Proceedings of the Thirty-Ninth AAAI Conference on Artificial Intelligence and Thirty-Seventh Conference on Innovative Applications of Artificial Intelligence and Fifteenth Symposium on Educational Advances in Artificial Intelligence, AAAI&#8217;25/IAAI&#8217;25/EAAI&#8217;25</source>. Washington, DC, USA: <publisher-name>AAAI Press</publisher-name>, <year>2025</year>, <fpage>326</fpage>&#8211;<lpage>33</lpage>.</mixed-citation></ref><ref id="btaf619-B15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Jin</surname><given-names>N</given-names></string-name>, <string-name name-style="western"><surname>Cheng</surname><given-names>L</given-names></string-name>, <string-name name-style="western"><surname>Geng</surname><given-names>Q</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Multiomics on mental stress-induced myocardial ischemia: a narrative review</article-title>. <source>Heart Mind</source> &#160;<year>2024</year>;<volume>8</volume>:<fpage>15</fpage>&#8211;<lpage>20</lpage>.</mixed-citation></ref><ref id="btaf619-B16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Kristiansen</surname><given-names>G</given-names></string-name>, <string-name name-style="western"><surname>Winzer</surname><given-names>K-J</given-names></string-name>, <string-name name-style="western"><surname>Mayordomo</surname><given-names>E</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>CD24 expression is a new prognostic marker in breast cancer</article-title>. <source>Clin Cancer Res</source> &#160;<year>2003</year>;<volume>9</volume>:<fpage>4906</fpage>&#8211;<lpage>13</lpage>.<pub-id pub-id-type="pmid">14581365</pub-id></mixed-citation></ref><ref id="btaf619-B17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Kukanja</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Langseth</surname><given-names>CM</given-names></string-name>, <string-name name-style="western"><surname>Rubio Rodr&#237;guez-Kirby</surname><given-names>LA</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Cellular architecture of evolving neuroinflammatory lesions and multiple sclerosis pathology</article-title>. <source>Cell</source> &#160;<year>2024</year>;<volume>187</volume>:<fpage>1990</fpage>&#8211;<lpage>2009.e19</lpage>.<pub-id pub-id-type="pmid">38513664</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.cell.2024.02.030</pub-id></mixed-citation></ref><ref id="btaf619-B18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Lester</surname><given-names>LB</given-names></string-name>, <string-name name-style="western"><surname>Langeberg</surname><given-names>LK</given-names></string-name>, <string-name name-style="western"><surname>Scott</surname><given-names>JD</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Anchoring of protein kinase a facilitates hormone-mediated&#8201;insulin&#8201;secretion</article-title>. <source>Proc Natl Acad Sci U S A</source> &#160;<year>1997</year>;<volume>94</volume>:<fpage>14942</fpage>&#8211;<lpage>7</lpage>.<pub-id pub-id-type="pmid">9405718</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1073/pnas.94.26.14942</pub-id><pub-id pub-id-type="pmcid">PMC25142</pub-id></mixed-citation></ref><ref id="btaf619-B19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name name-style="western"><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Zhang</surname><given-names>X</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Latent feature extraction with a prior-based self-attention framework for spatial transcriptomics</article-title>. <source>Genome Res</source> &#160;<year>2023</year>;<volume>33</volume>:<fpage>1757</fpage>&#8211;<lpage>73</lpage>.<pub-id pub-id-type="pmid">37903634</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1101/gr.277891.123</pub-id><pub-id pub-id-type="pmcid">PMC10691543</pub-id></mixed-citation></ref><ref id="btaf619-B20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Lipi&#324;ski</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Ciara</surname><given-names>E</given-names></string-name>, <string-name name-style="western"><surname>Jurkiewicz</surname><given-names>D</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Progressive familial intrahepatic cholestasis type 3: report of four clinical cases, novel ABCB4 variants and long-term follow-up</article-title>. <source>Ann Hepatol</source> &#160;<year>2021</year>;<volume>25</volume>:<fpage>100342</fpage>.<pub-id pub-id-type="pmid">33757843</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.aohep.2021.100342</pub-id></mixed-citation></ref><ref id="btaf619-B21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Sinjab</surname><given-names>A</given-names></string-name>, <string-name name-style="western"><surname>Min</surname><given-names>J</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Conserved spatial subtypes and cellular neighborhoods of cancer-associated fibroblasts revealed by single-cell spatial multi-omics</article-title>. <source>Cancer Cell</source> &#160;<year>2025</year>;<volume>43</volume>:<fpage>905</fpage>&#8211;<lpage>24.e6</lpage>.<pub-id pub-id-type="pmid">40154487</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.ccell.2025.03.004</pub-id><pub-id pub-id-type="pmcid">PMC12074878</pub-id></mixed-citation></ref><ref id="btaf619-B22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Long</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Ang</surname><given-names>KS</given-names></string-name>, <string-name name-style="western"><surname>Li</surname><given-names>M</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Spatially informed clustering, integration, and deconvolution of spatial transcriptomics with GraphST</article-title>. <source>Nat Commun</source> &#160;<year>2023</year>;<volume>14</volume>:<fpage>1155</fpage>.<pub-id pub-id-type="pmid">36859400</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41467-023-36796-3</pub-id><pub-id pub-id-type="pmcid">PMC9977836</pub-id></mixed-citation></ref><ref id="btaf619-B23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Mazzucchelli</surname><given-names>R</given-names></string-name>, <string-name name-style="western"><surname>Durum</surname><given-names>SK.</given-names></string-name></person-group> &#160;<article-title>Interleukin-7 receptor expression: intelligent design</article-title>. <source>Nat Rev Immunol</source> &#160;<year>2007</year>;<volume>7</volume>:<fpage>144</fpage>&#8211;<lpage>54</lpage>.<pub-id pub-id-type="pmid">17259970</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/nri2023</pub-id></mixed-citation></ref><ref id="btaf619-B24"><mixed-citation publication-type="other"><person-group person-group-type="author"><string-name name-style="western"><surname>Meng</surname><given-names>D, Yu F, Kaishen Y</given-names></string-name></person-group> &#160;<etal>et al</etal> scMMAE: masked cross-attention network for single-cell multimodal omics fusion to enhance unimodal omics. <source>Brief Bioinform</source> &#160;<year>2024</year>;26:bbaf010.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1093/bib/bbaf010</pub-id><pub-id pub-id-type="pmcid">PMC11757910</pub-id><pub-id pub-id-type="pmid">39851073</pub-id></mixed-citation></ref><ref id="btaf619-B25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Murphy</surname><given-names>ACH</given-names></string-name>, <string-name name-style="western"><surname>Young</surname><given-names>PW.</given-names></string-name></person-group> &#160;<article-title>The actinin family of actin cross-linking proteins&#8212;a genetic perspective</article-title>. <source>Cell Biosci</source> &#160;<year>2015</year>;<volume>5</volume>:<fpage>49</fpage>.<pub-id pub-id-type="pmid">26312134</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1186/s13578-015-0029-7</pub-id><pub-id pub-id-type="pmcid">PMC4550062</pub-id></mixed-citation></ref><ref id="btaf619-B26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Oliveira</surname><given-names>MFd</given-names></string-name>, <string-name name-style="western"><surname>Romero</surname><given-names>JP</given-names></string-name>, <string-name name-style="western"><surname>Chung</surname><given-names>M</given-names></string-name></person-group> &#160;<etal>et al</etal>; <collab>Visium HD Development Team</collab>. <article-title>High-definition spatial transcriptomic profiling of immune cell populations in colorectal cancer</article-title>. <source>Nat Genet</source> &#160;<year>2025</year>;<volume>57</volume>:<fpage>1512</fpage>&#8211;<lpage>23</lpage>.<pub-id pub-id-type="pmid">40473992</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41588-025-02193-3</pub-id><pub-id pub-id-type="pmcid">PMC12165841</pub-id></mixed-citation></ref><ref id="btaf619-B27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Oskarsson</surname><given-names>T.</given-names></string-name></person-group> &#160;<article-title>Extracellular matrix components in breast cancer progression and metastasis</article-title>. <source>Breast</source> &#160;<year>2013</year>;<volume>22 Suppl 2</volume>:<fpage>S66</fpage>&#8211;<lpage>72</lpage>.<pub-id pub-id-type="pmid">24074795</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.breast.2013.07.012</pub-id></mixed-citation></ref><ref id="btaf619-B28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Ren</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Walker</surname><given-names>BL</given-names></string-name>, <string-name name-style="western"><surname>Cang</surname><given-names>Z</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Identifying multicellular spatiotemporal organization of cells with SpaceFlow</article-title>. <source>Nat Commun</source> &#160;<year>2022</year>;<volume>13</volume>:<fpage>4076</fpage>.<pub-id pub-id-type="pmid">35835774</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41467-022-31739-w</pub-id><pub-id pub-id-type="pmcid">PMC9283532</pub-id></mixed-citation></ref><ref id="btaf619-B29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Ripoll</surname><given-names>VM</given-names></string-name>, <string-name name-style="western"><surname>Meadows</surname><given-names>NA</given-names></string-name>, <string-name name-style="western"><surname>Raggatt</surname><given-names>L-J</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Microphthalmia transcription factor regulates the expression of the novel osteoclast factor GPNMB</article-title>. <source>Gene</source> &#160;<year>2008</year>;<volume>413</volume>:<fpage>32</fpage>&#8211;<lpage>41</lpage>.<pub-id pub-id-type="pmid">18313864</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.gene.2008.01.014</pub-id></mixed-citation></ref><ref id="btaf619-B30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Scholzen</surname><given-names>T</given-names></string-name>, <string-name name-style="western"><surname>Gerdes</surname><given-names>J.</given-names></string-name></person-group> &#160;<article-title>The Ki-67 protein: from the known and the unknown</article-title>. <source>J Cell Physiol</source> &#160;<year>2000</year>;<volume>182</volume>:<fpage>311</fpage>&#8211;<lpage>22</lpage>.<pub-id pub-id-type="pmid">10653597</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1002/(SICI)1097-4652(200003)182:3&lt;311::AID-JCP1&gt;3.0.CO;2-9</pub-id></mixed-citation></ref><ref id="btaf619-B31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Seifert</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Przekopowitz</surname><given-names>M</given-names></string-name>, <string-name name-style="western"><surname>Taudien</surname><given-names>S</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Functional capacities of human IgM memory B cells in early inflammatory responses and secondary germinal center reactions</article-title>. <source>Proc Natl Acad Sci U S A</source> &#160;<year>2015</year>;<volume>112</volume>:<fpage>E546</fpage>&#8211;<lpage>55</lpage>.<pub-id pub-id-type="pmid">25624468</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1073/pnas.1416276112</pub-id><pub-id pub-id-type="pmcid">PMC4330750</pub-id></mixed-citation></ref><ref id="btaf619-B32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Serviss</surname><given-names>JT</given-names></string-name>, <string-name name-style="western"><surname>Andrews</surname><given-names>N</given-names></string-name>, <string-name name-style="western"><surname>Van den Eynden</surname><given-names>J</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>An antisense RNA capable of modulating the expression of the tumor suppressor microRNA-34a</article-title>. <source>Cell Death Dis</source> &#160;<year>2018</year>;<volume>9</volume>:<fpage>736</fpage>.<pub-id pub-id-type="pmid">29970884</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s41419-018-0777-5</pub-id><pub-id pub-id-type="pmcid">PMC6030072</pub-id></mixed-citation></ref><ref id="btaf619-B33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Shan</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Zhang</surname><given-names>Q</given-names></string-name>, <string-name name-style="western"><surname>Guo</surname><given-names>W</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>TIST: transcriptome and histopathological image integrative analysis for spatial transcriptomics</article-title>. <source>Genom Proteom Bioinform</source> &#160;<year>2022</year>;<volume>20</volume>:<fpage>974</fpage>&#8211;<lpage>88</lpage>.<pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/j.gpb.2022.11.012</pub-id><pub-id pub-id-type="pmcid">PMC10025771</pub-id><pub-id pub-id-type="pmid">36549467</pub-id></mixed-citation></ref><ref id="btaf619-B34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Taylor</surname><given-names>KM</given-names></string-name>, <string-name name-style="western"><surname>Vichova</surname><given-names>P</given-names></string-name>, <string-name name-style="western"><surname>Jordan</surname><given-names>N</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>ZIP7-mediated intracellular zinc transport contributes to aberrant growth factor signaling in antihormone-resistant breast cancer cells</article-title>. <source>Endocrinology</source> &#160;<year>2008</year>;<volume>149</volume>:<fpage>4912</fpage>&#8211;<lpage>20</lpage>.<pub-id pub-id-type="pmid">18583420</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1210/en.2008-0351</pub-id></mixed-citation></ref><ref id="btaf619-B35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Wong</surname><given-names>ST</given-names></string-name>, <string-name name-style="western"><surname>Athos</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Figueroa</surname><given-names>XA</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Calcium-stimulated adenylyl cyclase activity is critical for hippocampus-dependent long-term memory and late phase LTP</article-title>. <source>Neuron</source> &#160;<year>1999</year>;<volume>23</volume>:<fpage>787</fpage>&#8211;<lpage>98</lpage>.<pub-id pub-id-type="pmid">10482244</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1016/s0896-6273(01)80036-2</pub-id></mixed-citation></ref><ref id="btaf619-B36"><mixed-citation publication-type="other"><collab>Xenium In Situ Platform</collab>. 10x Genomics. <year>2024</year>.</mixed-citation></ref><ref id="btaf619-B37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Xie</surname><given-names>J</given-names></string-name>, <string-name name-style="western"><surname>Xie</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Tan</surname><given-names>W</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Deciphering the role of ELAVL1: insights from pan-cancer multiomics analyses with emphasis on nasopharyngeal carcinoma</article-title>. <source>J Transl Int Med</source> &#160;<year>2025</year>;<volume>13</volume>:<fpage>138</fpage>&#8211;<lpage>55</lpage>.<pub-id pub-id-type="pmid">40443402</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1515/jtim-2025-0009</pub-id><pub-id pub-id-type="pmcid">PMC12116272</pub-id></mixed-citation></ref><ref id="btaf619-B38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Xie</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Cui</surname><given-names>Y</given-names></string-name>, <string-name name-style="western"><surname>Tan</surname><given-names>T</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>FusionMamba: dynamic feature enhancement for multimodal image fusion with Mamba</article-title>. <source>Vis Intell</source> &#160;<year>2024</year>;<volume>2</volume>:<fpage>37</fpage>.</mixed-citation></ref><ref id="btaf619-B39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Xu</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Fu</surname><given-names>H</given-names></string-name>, <string-name name-style="western"><surname>Long</surname><given-names>Y</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Unsupervised spatially embedded deep representation of spatial transcriptomics</article-title>. <source>Genome Med</source> &#160;<year>2024</year>;<volume>16</volume>:<fpage>12</fpage>.<pub-id pub-id-type="pmid">38217035</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1186/s13073-024-01283-x</pub-id><pub-id pub-id-type="pmcid">PMC10790257</pub-id></mixed-citation></ref><ref id="btaf619-B3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Yong</surname><given-names>Z</given-names></string-name>, <string-name name-style="western"><surname>Xueying</surname><given-names>F</given-names></string-name>, <string-name name-style="western"><surname>Yan</surname><given-names>S</given-names></string-name>.</person-group> &#160;<article-title>IGHG1 promotes malignant progression in breast cancer cells through the regulation of AKT AND VEGF signaling</article-title>. <source>Biomol Biomed</source> &#160;<year>2023</year>;<volume>23</volume>:<fpage>616</fpage>&#8211;<lpage>23</lpage>.<pub-id pub-id-type="pmid">36883223</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.17305/bb.2022.8508</pub-id><pub-id pub-id-type="pmcid">PMC10351095</pub-id></mixed-citation></ref><ref id="btaf619-B40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Leung</surname><given-names>K-S</given-names></string-name>, <string-name name-style="western"><surname>Wong</surname><given-names>M-H</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Long non-coding RNA pairs to assist in diagnosing sepsis</article-title>. <source>BMC Genomics</source> &#160;<year>2021</year>;<volume>22</volume>:<fpage>275</fpage>.<pub-id pub-id-type="pmid">33863291</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1186/s12864-021-07576-4</pub-id><pub-id pub-id-type="pmcid">PMC8050902</pub-id></mixed-citation></ref><ref id="btaf619-B41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Meng</surname><given-names>D</given-names></string-name>, <string-name name-style="western"><surname>Chen</surname><given-names>D</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>scCaT: an explainable capsulating architecture for sepsis diagnosis transferring from single-cell RNA sequencing</article-title>. <source>PLoS Comput Biol</source> &#160;<year>2024</year>;<volume>20</volume>:<fpage>e1012083</fpage>.<pub-id pub-id-type="pmid">39432561</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1371/journal.pcbi.1012083</pub-id><pub-id pub-id-type="pmcid">PMC11527285</pub-id></mixed-citation></ref><ref id="btaf619-B42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Zhou</surname><given-names>X</given-names></string-name>, <string-name name-style="western"><surname>Dong</surname><given-names>K</given-names></string-name>, <string-name name-style="western"><surname>Zhang</surname><given-names>S</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Integrating spatial transcriptomics data across different conditions, technologies and developmental stages</article-title>. <source>Nat Comput Sci</source> &#160;<year>2023</year>;<volume>3</volume>:<fpage>894</fpage>&#8211;<lpage>906</lpage>.<pub-id pub-id-type="pmid">38177758</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.1038/s43588-023-00528-w</pub-id></mixed-citation></ref><ref id="btaf619-B43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name name-style="western"><surname>Zhu</surname><given-names>L</given-names></string-name>, <string-name name-style="western"><surname>Xu</surname><given-names>S</given-names></string-name>, <string-name name-style="western"><surname>Guo</surname><given-names>H</given-names></string-name></person-group> &#160;<etal>et al</etal> &#160;<article-title>Machine learning-based phenogroups and prediction model in patients with functional gastrointestinal disorders to reveal distinct disease subsets associated with gas production</article-title>. <source>J Transl Int Med</source> &#160;<year>2024</year>;<volume>12</volume>:<fpage>355</fpage>&#8211;<lpage>66</lpage>.<pub-id pub-id-type="pmid">39360163</pub-id><pub-id pub-id-type="doi" assigning-authority="pmc">10.2478/jtim-2024-0009</pub-id><pub-id pub-id-type="pmcid">PMC11444472</pub-id></mixed-citation></ref></ref-list></back></article></pmc-articleset>